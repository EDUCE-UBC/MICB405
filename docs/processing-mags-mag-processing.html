<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Processing MAGs {#MAG processing} | Introduction</title>
  <meta name="description" content="6 Processing MAGs {#MAG processing} | Introduction" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Processing MAGs {#MAG processing} | Introduction" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Processing MAGs {#MAG processing} | Introduction" />
  
  
  

<meta name="author" content="Pranav_Sampara" />


<meta name="date" content="2020-05-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="anvio-binning-exercise-anvio-binning-exercise.html"/>
<link rel="next" href="References.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#brief-introduction-to-omics-methods"><i class="fa fa-check"></i><b>1.1</b> Brief introduction to ’omics methods</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#some-key-aspects-of-metagenomics"><i class="fa fa-check"></i><b>1.2</b> Some key aspects of metagenomics</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#key-points-to-be-aware-of-and-known-pitfalls-in-metagenomics"><i class="fa fa-check"></i><b>1.3</b> Key points to be aware of and known pitfalls in metagenomics</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#basic-outline-of-a-metagenomics-pipeline"><i class="fa fa-check"></i><b>1.4</b> Basic outline of a metagenomics pipeline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="metagenomics-workflow-metagenomics-workflow.html"><a href="metagenomics-workflow-metagenomics-workflow.html"><i class="fa fa-check"></i><b>2</b> Metagenomics workflow {#Metagenomics workflow}</a></li>
<li class="chapter" data-level="3" data-path="background-information-background-information.html"><a href="background-information-background-information.html"><i class="fa fa-check"></i><b>3</b> Background information {#Background information}</a><ul>
<li class="chapter" data-level="3.1" data-path="background-information-background-information.html"><a href="background-information-background-information.html#project-information"><i class="fa fa-check"></i><b>3.1</b> Project information</a></li>
<li class="chapter" data-level="3.2" data-path="background-information-background-information.html"><a href="background-information-background-information.html#data-collection"><i class="fa fa-check"></i><b>3.2</b> Data collection</a></li>
<li class="chapter" data-level="3.3" data-path="background-information-background-information.html"><a href="background-information-background-information.html#data-availability"><i class="fa fa-check"></i><b>3.3</b> Data availability</a></li>
<li class="chapter" data-level="3.4" data-path="background-information-background-information.html"><a href="background-information-background-information.html#goal-of-the-exercise"><i class="fa fa-check"></i><b>3.4</b> Goal of the exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-anvio-anvio-introduction.html"><a href="introduction-to-anvio-anvio-introduction.html"><i class="fa fa-check"></i><b>4</b> Introduction to Anvio {#anvio introduction}</a><ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-anvio-anvio-introduction.html"><a href="introduction-to-anvio-anvio-introduction.html#what-is-anvio"><i class="fa fa-check"></i><b>4.1</b> What is Anvi’o</a></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-anvio-anvio-introduction.html"><a href="introduction-to-anvio-anvio-introduction.html#anvio-installation"><i class="fa fa-check"></i><b>4.2</b> Anvi’o installation</a></li>
<li class="chapter" data-level="4.3" data-path="introduction-to-anvio-anvio-introduction.html"><a href="introduction-to-anvio-anvio-introduction.html#binning-tools-installation"><i class="fa fa-check"></i><b>4.3</b> Binning tools installation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="anvio-binning-exercise-anvio-binning-exercise.html"><a href="anvio-binning-exercise-anvio-binning-exercise.html"><i class="fa fa-check"></i><b>5</b> Anvio binning exercise {#anvio binning exercise}</a><ul>
<li class="chapter" data-level="5.1" data-path="anvio-binning-exercise-anvio-binning-exercise.html"><a href="anvio-binning-exercise-anvio-binning-exercise.html#automatic-binning-on-anvio-using-metabat2-maxbin2-and-concoct"><i class="fa fa-check"></i><b>5.1</b> Automatic binning on Anvi’o using METABAT2, MAXBIN2, and CONCOCT</a><ul>
<li class="chapter" data-level="5.1.1" data-path="anvio-binning-exercise-anvio-binning-exercise.html"><a href="anvio-binning-exercise-anvio-binning-exercise.html#note-to-educe-tas"><i class="fa fa-check"></i><b>5.1.1</b> Note to EDUCE-TA’s</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="anvio-binning-exercise-anvio-binning-exercise.html"><a href="anvio-binning-exercise-anvio-binning-exercise.html#assessing-quality-bins"><i class="fa fa-check"></i><b>5.2</b> Assessing quality bins</a><ul>
<li class="chapter" data-level="5.2.1" data-path="anvio-binning-exercise-anvio-binning-exercise.html"><a href="anvio-binning-exercise-anvio-binning-exercise.html#note-the-mag-quality"><i class="fa fa-check"></i><b>5.2.1</b> Note the MAG quality</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="anvio-binning-exercise-anvio-binning-exercise.html"><a href="anvio-binning-exercise-anvio-binning-exercise.html#manual-refinement"><i class="fa fa-check"></i><b>5.3</b> Manual refinement</a></li>
<li class="chapter" data-level="5.4" data-path="anvio-binning-exercise-anvio-binning-exercise.html"><a href="anvio-binning-exercise-anvio-binning-exercise.html#iterative-assessment-and-refinement"><i class="fa fa-check"></i><b>5.4</b> Iterative assessment and refinement</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="processing-mags-mag-processing.html"><a href="processing-mags-mag-processing.html"><i class="fa fa-check"></i><b>6</b> Processing MAGs {#MAG processing}</a><ul>
<li class="chapter" data-level="6.1" data-path="processing-mags-mag-processing.html"><a href="processing-mags-mag-processing.html#taxonomic-classification-using-gtdb-tk"><i class="fa fa-check"></i><b>6.1</b> Taxonomic classification using GTDB-Tk</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="processing-mags-mag-processing" class="section level1">
<h1><span class="header-section-number">6</span> Processing MAGs {#MAG processing}</h1>
<p>Taxonomic classification can be done with GTDB-Tk. GTDB-Tk is a toolkit for using the Genome Taxonomy Database (GTDB) to classify taxonomy of the MAGs. Please read <a href="https://www.nature.com/articles/nbt.4229">Parks et al. 2018</a> to learn more about GTDB and <a href="https://academic.oup.com/bioinformatics/article/36/6/1925/5626182">Chaumeil et al. 2020</a> for details on the GTDB-Tk tool.</p>
<p>For an in-depth commentary on how to utilize GTDB-Tk please visit <a href="https://ecogenomics.github.io/GTDBTk/" class="uri">https://ecogenomics.github.io/GTDBTk/</a></p>
<p>After taxonomic classification, functional annotation can be done using TreeSAPP</p>
<p>You will be implementing a pipeline called Tree-based Sensitive and Accurate Protein Profiler (<strong>TreeSAPP</strong>) for automated reconstruction of the nitrogen cycle along defined redox gradients in Saanich Inlet using the Google Cloud Platform. TreeSAPP takes either metagenomic or metatranscriptomic reads and aligns them to previously binned sequence data with each bin representing a putative microbial taxon.</p>
<p>TreeSAPP determines three things:</p>
<p>A. What taxa are in our metagenomic and metatranscriptomic data represented?</p>
<p>B. Which marker genes do these taxa contain (metagenomic data) or actually express (metatranscriptomic data)?</p>
<p>C. At what levels are those genes represented (metagenomic data) or expressed by the taxon?</p>
<p>Please see the <a href="https://github.com/hallamlab/TreeSAPP/wiki/Classifying-sequences-with-treesapp-assign">TreeSAPP wiki</a> for more information on <code>treesapp assign</code>, the subcommand you will use. You will be provided with a script template for both the shell and R portion of your analysis (“treesapp_analysis.sh” and “treesapp_analysis.R”) that will guide you as you develop your code.</p>
<div id="taxonomic-classification-using-gtdb-tk" class="section level2">
<h2><span class="header-section-number">6.1</span> Taxonomic classification using GTDB-Tk</h2>
<p>The following commands will generate taxonomic classification of archaeal and bacterial MAGs</p>
<pre><code>#Create GTDB-Tk output directory
mkdir ~/path_to_gtdbtk_output_dir
#Create variable for output directory
gtdbtk_out=~/path_to_gtdb_output_dir
#Establish bins’ fasta files directory 
in_fasta=~/path_to_output_fasta_files
#Export GTDB-Tk data path
export GTDBTK_DATA_PATH=~/path_to_GTDB_data
#Operational parameters – change as required on your system
threads=48
pplacer_threads=24
#Run GTDB-Tk
gtdbtk classify_wf -x fa --genome_dir $in_fasta \
    --out_dir $gtdbtk_out \
    --cpus $threads \
    --pplacer_cpus $pplacer_threads</code></pre>
<p>You would obtain two soft links in the gtdbtk output directory, each for bacteria and archaea taxonomic classification. Please follow the soft link to locate the actual files for taxonomic classification, and download to your system.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="anvio-binning-exercise-anvio-binning-exercise.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="References.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
