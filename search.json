[{"path":"index.html","id":"about","chapter":"About","heading":"About","text":"Welcome MICB 405 Tutorials website! find tutorials tutorial worksheets uploaded week ahead Friday tutorials.MICB 405 introduces concepts applications sequence-based bioinformatics research across several broad topic areas, including Unix/Linux command line massively parallel sequencing applications. biological perspective, discuss main considerations applications computational tools used subject areas. team projects supplementing lecture materials, work within groups apply bioinformatics tools experimental data sets.Please visit Canvas MICB 405 site syllabus, schedule (via calendar), lectures, module quizzes team project details.","code":""},{"path":"windows-10.html","id":"windows-10","chapter":"Windows 10","heading":"Windows 10","text":"","code":""},{"path":"windows-10.html","id":"updating-the-operating-system","chapter":"Windows 10","heading":"Updating the operating system","text":"DisclaimerIf update upgrade operating system (OS) risk!general, many good reasons update OS. software tools functionality used tutorials work recent OS versions. Updating OS also ensure latest security updates installed help prevent unauthorized access computer.two main reasons prevent updating OS:hardware support updated OS.software depend might work newer OS.Please update latest version Windows 10: version 21H1.\n(Major Windows versions indicate half year released, .e. latest version 21H1 first half—May—2021.)Check current Windows version : Select Windows Start button > Settings > System > > scroll bottom page\nlatest version installed: Select Windows Start button > Settings > Update & Security > Windows Update\nlatest version installed: Select Windows Start button > Settings > Update & Security > Windows UpdateIf Windows Update offer latest version, manually update going Windows 10 Downloads choosing latest version.Windows Update offer latest version, manually update going Windows 10 Downloads choosing latest version.","code":""},{"path":"windows-10.html","id":"accessing-a-terminal-to-connect-with-the-server","chapter":"Windows 10","heading":"Accessing a terminal to connect with the server","text":"instructions ensure local computer can connect Linux server copy files using software tool called OpenSSH.OpenSSH comes pre-installed Windows 10 version 1803 newer. updated latest Windows 10 version, already OpenSSH available . Windows 10 version older update, follow official Microsoft documentation installing OpenSSH Client.OpenSSH comes pre-installed Windows 10 version 1803 newer. updated latest Windows 10 version, already OpenSSH available . Windows 10 version older update, follow official Microsoft documentation installing OpenSSH Client.simplest way access OpenSSH Windows open “Command Prompt” application, discoverable search bar. application provide sufficient functionality server-based work MICB405.simplest way access OpenSSH Windows open “Command Prompt” application, discoverable search bar. application provide sufficient functionality server-based work MICB405., can proceed Tutorial 1., can proceed Tutorial 1.","code":""},{"path":"windows-10.html","id":"additional-considerations-for-windows","chapter":"Windows 10","heading":"Additional considerations for Windows","text":"aware open Command Prompt, using entirely different local shell set commands unique Linux. connected server (using OpenSSH, see ) using Bash. Tread caution executing commands ssh scp tutorials still Command Prompt (.e. connected server).","code":""},{"path":"windows-10.html","id":"optional-windows-subsystem-for-linux","chapter":"Windows 10","heading":"Optional: Windows Subsystem for Linux","text":"can create true Linux environment command line setting Windows Subsystem Linux (WSL). can access Bash virtualized Linux distribution, either directly distribution’s Windows app Command Prompt practice run Linux commands machine without connecting server.","code":""},{"path":"windows-10.html","id":"resources","chapter":"Windows 10","heading":"Resources","text":"version Windows operating system running?Update Windows 10","code":""},{"path":"macos.html","id":"macos","chapter":"macOS","heading":"macOS","text":"","code":""},{"path":"macos.html","id":"updating-the-operating-system-1","chapter":"macOS","heading":"Updating the operating system","text":"DisclaimerIf update upgrade operating system (OS) risk!general, many good reasons update OS. software tools functionality used tutorials work recent OS versions. Updating OS also ensure latest security updates installed help prevent unauthorized access computer.two main reasons prevent updating OS:hardware support updated OS.software depend might work newer OS.Please upgrade latest version macOS, Big Sur.Please upgrade latest version macOS, Big Sur.Check current version macOS. latest version, follow upgrade instructions Apple support page.Check current version macOS. latest version, follow upgrade instructions Apple support page.upgrade latest version, follow instructions find system requirements upgrade latest versions available . need maintain 32-bit compatibility software, upgrade higher macOS 10.14 Mojave.upgrade latest version, follow instructions find system requirements upgrade latest versions available . need maintain 32-bit compatibility software, upgrade higher macOS 10.14 Mojave.","code":""},{"path":"macos.html","id":"accessing-a-terminal-to-connect-with-the-server-1","chapter":"macOS","heading":"Accessing a terminal to connect with the server","text":"macOS come pre-installed Terminal app located /Applications/Utilities/Terminal.app.macOS come pre-installed Terminal app located /Applications/Utilities/Terminal.app., can proceed Tutorial 1., can proceed Tutorial 1.","code":""},{"path":"macos.html","id":"resources-1","chapter":"macOS","heading":"Resources","text":"Find macOS Mac usingHow upgrade macOS Big SurHow get old versions macOS32-bit app compatibility macOS High Sierra 10.13.4 later","code":""},{"path":"linux.html","id":"linux","chapter":"Linux","heading":"Linux","text":"","code":""},{"path":"linux.html","id":"updating-the-operating-system-2","chapter":"Linux","heading":"Updating the operating system","text":"DisclaimerIf update upgrade operating system (OS) risk!general, many good reasons update OS. software tools functionality used tutorials work recent OS versions. Updating OS also ensure latest security updates installed help prevent unauthorized access computer.two main reasons prevent updating OS:hardware support updated OS.software depend might work newer OS.always best practice keep software packages date Linux well.always best practice keep software packages date Linux well.Debian-based (apt) distributions, simple sudo apt update + sudo apt upgrade , commands vary distributions.Debian-based (apt) distributions, simple sudo apt update + sudo apt upgrade , commands vary distributions.","code":""},{"path":"linux.html","id":"accessing-a-terminal-to-connect-with-the-server-2","chapter":"Linux","heading":"Accessing a terminal to connect with the server","text":"Use preferred Terminal app. location may vary depending distribution. GUIs, able find searching “Terminal”.Use preferred Terminal app. location may vary depending distribution. GUIs, able find searching “Terminal”., can proceed Tutorial 1., can proceed Tutorial 1.","code":""},{"path":"r-and-rstudio.html","id":"r-and-rstudio","chapter":"R and RStudio","heading":"R and RStudio","text":"complete installs R RStudio, must administrator privileges machine. Choose version appropriate operating system. can also watch video Mac Windows install (need install R RStudio, none programs mentioned videos). Please also note versions R RStudio video older. Instead, install update latest version supported operating system.","code":""},{"path":"r-and-rstudio.html","id":"install-r","chapter":"R and RStudio","heading":"Install R","text":"Go https://cran.r-project.org/Go https://cran.r-project.org/Choose among “Download Install R” section (“Source Code Platforms”).\nLatest version: 4.1.1\n(macOS Yosemite older: legacy version 3.3.3)Choose among “Download Install R” section (“Source Code Platforms”).Latest version: 4.1.1(macOS Yosemite older: legacy version 3.3.3)Note Mac usersIf M1 (higher) Mac, must install Intel version R (Bioconductor packages installed yet compatible arm64 version).Note usersYou must R installed proceeding next step.","code":""},{"path":"r-and-rstudio.html","id":"install-rstudio","chapter":"R and RStudio","heading":"Install RStudio","text":"Go https://rstudio.com/products/rstudio/download/#downloadGo https://rstudio.com/products/rstudio/download/#downloadSelect FREE Desktop version.Select FREE Desktop version.Choose among “Installers Supported Platforms” section (“Zip/Tarballs”) follow link older versions RStudio need legacy version.\nLatest version: 2021.09.0\n(macOS El Capitan older: legacy version 1.1.463)Choose among “Installers Supported Platforms” section (“Zip/Tarballs”) follow link older versions RStudio need legacy version.Latest version: 2021.09.0(macOS El Capitan older: legacy version 1.1.463)","code":""},{"path":"r-and-rstudio.html","id":"install-r-packages","chapter":"R and RStudio","heading":"Install R packages","text":"Open RStudio, :Select “Console” tab left panel .Copy following code prompt >  install necessary packages:\n\n(!require(tidyverse))    install.packages(\"tidyverse\")\n(!require(pheatmap))     install.packages(\"pheatmap\")\n(!require(RColorBrewer)) install.packages(\"RColorBrewer\")\n(!require(BiocManager))  install.packages(\"BiocManager\")\n(!require(DESeq2))       BiocManager::install(\"DESeq2\")\ninstalling (updating, see ) packages, might prompted:\n  binary version available, source version later:\n\n<table package names>\n\nwant install sources package need compilation? (Yes//cancel)\nAlways enter followed enter.Copy following code prompt >  install necessary packages:installing (updating, see ) packages, might prompted:Always enter followed enter.Update packages selecting “Packages” tab bottom right panel  click “Update” .\nUpdate packages selecting “Packages” tab bottom right panel  click “Update” .packages listed, first click “Select ”  “Install Updates” .\npackages listed, first click “Select ”  “Install Updates” .","code":"\nif (!require(tidyverse))    install.packages(\"tidyverse\")\nif (!require(pheatmap))     install.packages(\"pheatmap\")\nif (!require(RColorBrewer)) install.packages(\"RColorBrewer\")\nif (!require(BiocManager))  install.packages(\"BiocManager\")\nif (!require(DESeq2))       BiocManager::install(\"DESeq2\")  There is a binary version available, but the source version is later:\n\n<table of package names>\n\nDo you want to install from sources the package which need compilation? (Yes/no/cancel)"},{"path":"r-and-rstudio.html","id":"check-that-it-worked","chapter":"R and RStudio","heading":"Check that it worked","text":"","code":""},{"path":"r-and-rstudio.html","id":"troubleshooting","chapter":"R and RStudio","heading":"Troubleshooting","text":"","code":""},{"path":"r-and-rstudio.html","id":"rstudio-looks-incorrect","chapter":"R and RStudio","heading":"RStudio looks incorrect","text":"confirmed RStudio open don’t see panels depicted , RStudio menu bar, select View > Panes > Show panes.","code":""},{"path":"r-and-rstudio.html","id":"my-computer-wont-let-me-open-the-downloaded-files-to-install-them","chapter":"R and RStudio","heading":"My computer won’t let me open the downloaded files to install them","text":"Mac: right-click choose “Open ” > “Installer.app (default)” select “Open” prompted sure want open fileWindows: right-click choose “Run administrator”","code":""},{"path":"r-and-rstudio.html","id":"still-doesnt-work","chapter":"R and RStudio","heading":"Still doesn’t work","text":"Please come one office hours get help.","code":""},{"path":"r-and-rstudio.html","id":"further-resources","chapter":"R and RStudio","heading":"Further resources","text":"Install RR FAQR Installation Administration ManualHow Use RStudioRStudio Public Discussion & Troubleshooting Guide","code":""},{"path":"overview.html","id":"overview","chapter":"Overview","heading":"Overview","text":"","code":""},{"path":"overview.html","id":"formatting","chapter":"Overview","heading":"Formatting","text":"text-paragraphs, code always formatted monospace font surrounded box, like . Longer examples code separate box.many cases output code boxes .Replace placeholder indicated angular brackets <placeholder> code.Pressing Key keyboard formatted like .","code":"First line of code\nSecond line of code\n..."},{"path":"introduction-linux-server-accounts.html","id":"introduction-linux-server-accounts","chapter":"1 Introduction & Linux Server Accounts","heading":"1 Introduction & Linux Server Accounts","text":"Welcome first MICB 405 lab! Today, ’re going get started essential skills tools ’ll using rest course.","code":""},{"path":"introduction-linux-server-accounts.html","id":"slides","chapter":"1 Introduction & Linux Server Accounts","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"introduction-linux-server-accounts.html","id":"logging-in","chapter":"1 Introduction & Linux Server Accounts","heading":"Logging in","text":"followed setup steps opened Command Prompt (Windows) Terminal (macOS, Linux), ready log !Use following command, replacing <username> actual username:Enter password prompted. Don’t worry characters don’t appear - intentional security feature.may respond additonal prompts typing answer (yes) pressing Enter.Let’s break command : ssh command stands “secure shell”. allows users log remote (opposite “local”, computer instance) servers. following text argument. may many arguments separated spaces. <username> mostly obvious, crucially positions shell home directory username server’s system correct permissions. everyone log root (“Administrator” Windows-speak) bad. orca1.bcgsc.ca (everything @) known hostname domain name name device network connected . Super-nerds sometimes replace IP address.","code":"ssh <username>@orca1.bcgsc.ca"},{"path":"introduction-linux-server-accounts.html","id":"bonus","chapter":"1 Introduction & Linux Server Accounts","heading":"Bonus","text":"Review manual pages ls, cd, pwd typing man followed command. Can use move local machine’s folder system find ? Orca server?exit man page, press q.","code":""},{"path":"introduction-linux-server-accounts.html","id":"delve-into-man-pages-and-help","chapter":"1 Introduction & Linux Server Accounts","heading":"Delve into man pages and help","text":"difference man page, --help -h argument added command? use either option? (try commands, look StackExchange ’re confused)difference man page, --help -h argument added command? use either option? (try commands, look StackExchange ’re confused)list Bash commands often used bioinformatics. Look man page least one . think ? Hypothetically, way think used bioinformatics context? arguments handy? Discuss within group!\ngrep\ntr\nawk\nlist Bash commands often used bioinformatics. Look man page least one . think ? Hypothetically, way think used bioinformatics context? arguments handy? Discuss within group!greptrawk","code":""},{"path":"introduction-linux-server-accounts.html","id":"terminal-keyboard-shortcuts","chapter":"1 Introduction & Linux Server Accounts","heading":"Terminal keyboard shortcuts","text":"typing text, can navigate, copy, paste text without using mouse? practice, lot faster.Terminal keyboard shortcuts","code":""},{"path":"introduction-linux-server-accounts.html","id":"advanced","chapter":"1 Introduction & Linux Server Accounts","heading":"Advanced","text":"Create new file running nano testfile.txt home directory local machine (Use ctrl + o save ctrl + x exit nano).","code":""},{"path":"introduction-linux-server-accounts.html","id":"additonal-resources","chapter":"1 Introduction & Linux Server Accounts","heading":"Additonal resources","text":"complete tasks, check page reading practice!!","code":""},{"path":"bash-and-scripting.html","id":"bash-and-scripting","chapter":"2 Bash and scripting","heading":"2 Bash and scripting","text":"","code":""},{"path":"bash-and-scripting.html","id":"slides-1","chapter":"2 Bash and scripting","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"bash-and-scripting.html","id":"exercise-1","chapter":"2 Bash and scripting","heading":"Exercise 1","text":"Write shell script prints Shell Scripting Fun! screen.\nNow modify shell script include variable. variable hold contents message Shell Scripting Fun!.","code":""},{"path":"bash-and-scripting.html","id":"exercise-2","chapter":"2 Bash and scripting","heading":"Exercise 2","text":"Write shell script check see file foobar exists. exist, display \"foobar\" definitely . Next, check see can write file. can, display permissions edit \"foobar\". , display permissions edit \"foobar\".","code":""},{"path":"bash-and-scripting.html","id":"exercise-3","chapter":"2 Bash and scripting","heading":"Exercise 3","text":"Write shell script displays man, bear, pig, dog, cat, sheep screen appearing separate line. Try lines possible .e. repeating commands excessively. Hint: may create “Bash array” words line.","code":""},{"path":"bash-and-scripting.html","id":"exercise-4","chapter":"2 Bash and scripting","heading":"Exercise 4","text":"Write shell script takes name file directory (argument) prints regular file, directory, another type file screen.","code":""},{"path":"bash-and-scripting.html","id":"exercise-5","chapter":"2 Bash and scripting","heading":"Exercise 5","text":"Create script searches files /projects/micb405/data/bordetella/* /projects/micb405/data/bordetella/Full_Run/*following sequenceGCGCGCCTGGGCCCGGGCCTGCCCGCGATCGGCGCGGCGCACGATCAAGGGCATGGCGACATTGTCCAGCGCCGTGAACTCCGGCAGCAGGTGATGGAACTGGTAGACAAAGCCCAGGCTGCGATTGCGCAAGGCGCTCTTGCGGGATTCGGACAGGCCGTCGGCCGAGGTGCCGTCGACCACGACCGAGCCGCTGCTGGGCACATCCAGCAGGCCCAGGATGTGCAGCAGCGTGCTCTTGCCCGACCCCand produces following (similar) output:","code":"ahauduc_mb20@orca01:~$ bash script.bash\nF01_R1.fastq contains the sequence\nF01_R1_1M.fastq does not contain the sequence\nF01_R2.fastq does not contain the sequence\nF01_R2_1M.fastq does not contain the sequence"},{"path":"bash-and-scripting.html","id":"additional-resources","chapter":"2 Bash and scripting","heading":"Additional resources","text":"help, check looping scripting chapters Software Carpentry!","code":""},{"path":"fastqc.html","id":"fastqc","chapter":"3 FastQC","heading":"3 FastQC","text":"","code":""},{"path":"fastqc.html","id":"slides-2","chapter":"3 FastQC","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"fastqc.html","id":"exercise-1-1","chapter":"3 FastQC","heading":"Exercise 1","text":"Navigate /projects/micb405/data/Ebola. see paired-end FASTQ files. Let’s say files just came sequencer, want take quick look ensure nothing went awry sequencing process. ’re interested exact stats, still want take look modules graphical HTML report.Perform FastQC files, outputting results somewhere home directory.Next, scp just HTML files computer. (Hint: remember * refers name file within folder. might modify refer files ending .html?)Now, find transferred pair HTML files computer open web browser choice!","code":""},{"path":"fastqc.html","id":"exercise-2-1","chapter":"3 FastQC","heading":"Exercise 2","text":"Take look different modules FastQC output. Check “Per base sequence quality”, “Per sequence quality scores”, “Per base sequence content” Describe considered acceptable FastQC. “Per base sequence content”, need change FastQC flag module warning?Take look “Per sequence GC content”. went wrong ? shifting distribution mean matched theoretical mean sufficient FastQC flag acceptable?","code":""},{"path":"fastqc.html","id":"bonus-1","chapter":"3 FastQC","heading":"Bonus","text":"Look “Sequence Duplication Levels”. pattern distinct, ’s highly unusual whole-genome sequencing (DNA) run. However, let’s say know sequencing run done perfectly. kind genetic epigenetic material sequenced , rather simple DNA FastQC expects, causes sequences appear many times?Look help page fastp choose one trimming filtering step. Apply filtering Ebola FASTQs output filtered FASTQ directory home directory. run fastqc filtered FASTQs, can observe difference report stemming filtering steps enacted? can also use sandbox play around different fastp parameters!","code":""},{"path":"fastqc.html","id":"additonal-resources-1","chapter":"3 FastQC","heading":"Additonal resources","text":"FastQC tutorial FAQFastQC tutorial FAQFastQC manualFastQC manual","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"working-with-samtools-and-bcftools-part-1","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"4 Working with SAMtools and BCFtools Part 1","text":"","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"slides-3","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"main-exercise","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Main Exercise","text":"Create new SAM file aligning following FASTQ files bordetella reference genome using bwa mem script.\n# FASTA\n/projects/micb405/analysis/references/ASM107827v1/GCA_001078275.1_ASM107827v1_genomic.fna\n\n# FASTQ\n/projects/micb405/data/bordetella/F01_R1_1M.fastq\n/projects/micb405/data/bordetella/F01_R2_1M.fastqCreate new SAM file aligning following FASTQ files bordetella reference genome using bwa mem script.Run samtools flagstat resulting SAM file. different lines mean?Run samtools flagstat resulting SAM file. different lines mean?Next, create script processes resulting SAM indexed, sorted BAM duplicates removed.Next, create script processes resulting SAM indexed, sorted BAM duplicates removed.sorting duplicate removal, “sanity check” step perform output (hint… function within samtools can allow check binary BAM file eye) verify reads sorted (easier), duplicates removed (harder)? looking confirm commands worked intended?sorting duplicate removal, “sanity check” step perform output (hint… function within samtools can allow check binary BAM file eye) verify reads sorted (easier), duplicates removed (harder)? looking confirm commands worked intended?, add line script call variants using bcftools! may take , run happens background check back later?, add line script call variants using bcftools! may take , run happens background check back later?","code":"# FASTA\n/projects/micb405/analysis/references/ASM107827v1/GCA_001078275.1_ASM107827v1_genomic.fna\n\n# FASTQ\n/projects/micb405/data/bordetella/F01_R1_1M.fastq\n/projects/micb405/data/bordetella/F01_R2_1M.fastq"},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"bonus-2","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Bonus","text":"Download reference, bam, bam.bai, vcf.gz, vc.gz.tbi files view IGV viewer. Go one areas marked variant bcftools call. agree “call”?","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"additional-resources-1","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Additional resources","text":"BWA manual pagesSAMtools manual pagesBCFtools manual pagesIntroduction BAM file formatIntroduction VCF file formatIGV downloadIGV user guide","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"working-with-samtools-and-bcftools-part-2","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"5 Working with SAMtools and BCFtools Part 2","text":"","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"slides-4","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"exercise","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"Exercise","text":"Create new alignment using bwa aln.quick comparison using SN metrics samtools stats bwa aln BAM previous bwa mem BAM. one metric changed might ?Filter bwa aln alignment order keep reads mapping quality threshold choice.\nquick side--side comparison coverage new old bwa aln alignments using bwa stats. introducing quality threshold lead difference ? Can explain pros cons filtering mapping quality terms sensitivity specificity?\nChoosing arbitrary area along Bordetella’s single contig, one difference can spot new old bwa aln alignments besides read depth? (Hint: take look bit flags positions, consult IGV’s coloring scheme.)\nquick side--side comparison coverage new old bwa aln alignments using bwa stats. introducing quality threshold lead difference ? Can explain pros cons filtering mapping quality terms sensitivity specificity?Choosing arbitrary area along Bordetella’s single contig, one difference can spot new old bwa aln alignments besides read depth? (Hint: take look bit flags positions, consult IGV’s coloring scheme.)","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"additional-resources-2","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"Additional resources","text":"BWA manual pagesSAMtools manual pagesBCFtools manual pagesIntroduction BAM file formatIntroduction VCF file formatIGV downloadIGV user guide","code":""},{"path":"chip-seq-analysis.html","id":"chip-seq-analysis","chapter":"6 ChIP-seq analysis","heading":"6 ChIP-seq analysis","text":"","code":""},{"path":"chip-seq-analysis.html","id":"slides-5","chapter":"6 ChIP-seq analysis","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"chip-seq-analysis.html","id":"setup","chapter":"6 ChIP-seq analysis","heading":"6.1 Setup","text":"Make sure IGV installed laptopMake sure IGV installed laptopCheck macs2 installed $PATH running macs2Check macs2 installed $PATH running macs2If see folder macs2 installed, run:\npip3 install macs2\npip3 install --upgrade numpyIf see folder macs2 installed, run:Set new folder work tutorial:\nmkdir ~/ChIP_tutorial\ncd ~/ChIP_tutorialSet new folder work tutorial:Check files needed tutorial using ls -lh /projects/micb405/data/mouse/chip_tutorial. ChIP-seq reads constitute main input analysis.Check files needed tutorial using ls -lh /projects/micb405/data/mouse/chip_tutorial. ChIP-seq reads constitute main input analysis.","code":"pip3 install macs2\npip3 install --upgrade numpymkdir ~/ChIP_tutorial\ncd ~/ChIP_tutorial"},{"path":"chip-seq-analysis.html","id":"suggested-workflow","chapter":"6 ChIP-seq analysis","heading":"6.2 Suggested workflow","text":"(recommended) tools working complete project include:BWASAMtoolsMACS2IGV (installed computer)","code":""},{"path":"chip-seq-analysis.html","id":"aligning-using-bwa-mem","chapter":"6 ChIP-seq analysis","heading":"6.3 Aligning using BWA-MEM","text":"now process map reads using bwa mem. Note run time command syntax bwa mem different (easier faster) bwa aln introduced class. alignment process take ~20 min complete depending server load. highly recommended construct commands within shell script generated associated log files redirecting STDOUT described class. make subsequent commands easier, remember can define paths commonly used files/resources script shell variables. example, can define path indexed mm10 genome directory tutorial input files stored (see ). Best practice use absolute rather relative path defining variables, ensure script behave similarly matter located filesystem.need export variable want add current shell persist sessions. Since script runs subshell continuous session unique variables, ’s necessary export variables within .now familiar, defined can call paths script/shell entering special character $ followed variable name shown . following command run bwa mem stream sam file samtools view, automatically convert bam file. can use design .Note -t 8 multithreaded processing improve speed. $GENOME specifies location reference genome use. $DATA/Naive_H3K27ac_1.fastq $DATA/Naive_H3K27ac_2.fastq specifies location reads. step take time. Expect program run 20 mins longer depending server load. can add nohup front command, front command running script commands, order assure disconnected server, analysis steps stop.","code":"GENOME=/projects/micb405/analysis/references/mm10/mm10.fa\nDATA=/projects/micb405/data/mouse/chip_tutorial# Input a.k.a. control alignment\nbwa mem \\\n  -t 8 \\\n  $GENOME \\\n  $DATA/Naive_Input_1.fastq \\\n  $DATA/Naive_Input_2.fastq \\\n  | samtools view -h -b - -o Naive_Input.bam\n\n# Treatment a.k.a. immunoprecipitated a.k.a. IP alignment\nbwa mem \\\n  -t 8 \\\n  $GENOME \\\n  $DATA/Naive_H3K27ac_1.fastq \\\n  $DATA/Naive_H3K27ac_2.fastq \\\n  | samtools view -h -b - -o Naive_H3K27ac.bam"},{"path":"chip-seq-analysis.html","id":"check-files","chapter":"6 ChIP-seq analysis","heading":"6.4 Check files","text":"end, something similar :","code":"user01@orca01:~/ChIP_tutorial$ ls -lh\ntotal 8.7G\n-rw-r--r-- 1 mhirst orca_users 1.2G Oct  4 05:33 Naive_H3K27ac.bam\n-rw-r--r-- 1 mhirst orca_users 1.2G Oct  4 05:36 Naive_Input.bam\n-rw------- 1 mhirst orca_users   58 Oct  4 05:36 nohup.out"},{"path":"chip-seq-analysis.html","id":"sort-mark-duplicates-and-index-alignments-using-sambamba","chapter":"6 ChIP-seq analysis","heading":"6.5 Sort, mark duplicates, and index alignments using SAMBAMBA","text":"output bwa mem unsorted SAM file. Downstream tools require sorted BAM file input, intermediate step sort index alignment facilitate future steps, similar covered samtools/bcftools tutorial.Repeat treatment file well.","code":"# Tag mates\nsamtools fixmate -m Naive_Input.bam Naive_Input.fixmate.bam\n# Position sort for markdup\nsamtools sort Naive_Input.fixmate.bam -o Naive_Input.fixmate.sort.bam\n# Mark duplicates. Note that you don't have to remove them as this is done by MACS2 automatically\nsamtools markdup -S Naive_Input.fixmate.sort.bam Naive_Input.markdup.bam\n# Sort again\nsamtools sort Naive_Input.markdup.bam -o Naive_Input.final.bam\n# Index BAM\nsamtools index Naive_Input.final.bam"},{"path":"chip-seq-analysis.html","id":"clean-up-intermediate-files","chapter":"6 ChIP-seq analysis","heading":"6.6 Clean-up intermediate files","text":"Now time clean-intermediate files needed downstream, keeping .final.bam files needed MACS2. finished cleaning files working directory ~2.5G total.","code":""},{"path":"chip-seq-analysis.html","id":"call-peaks-using-macs2","chapter":"6 ChIP-seq analysis","heading":"6.7 Call peaks using MACS2","text":"peak calling, necessary sample data set, well control data set. MACS2 offers option perform regular (narrow) broad peak-calling, case, regular peak calling, however instructions similar broad peak-calling just add additional flag --broad command.call peaks sample Naive_H3K27ac.final.bam using Naive_Input.final.bam control (background). sorted, duplicate-marked bam files samples, can perform MACS2 peakcalling like :-t treatment IP (ImmunoPrecipitated) aligned dup-marked bam fileThe -c control INPUT aligned dup-marked bam fileThe -f indicates input file type (BAM paired-end BAMPE case)-g indicates effective genome size (precomputed mm10 provided mm)-n prefix give output filesThe -B indicates program create BedGraph (.bdg) file resultsThe -q FDR cutoff call peaks","code":"macs2 callpeak \\\n  -t Naive_H3K27ac.final.bam \\\n  -c Naive_Input.final.bam \\\n  -f BAMPE \\\n  -g mm \\\n  -n Naive_H3K27ac \\\n  -B \\\n  -q 0.01"},{"path":"chip-seq-analysis.html","id":"check-files-1","chapter":"6 ChIP-seq analysis","heading":"6.8 Check files","text":"end, something similar :","code":"user01@orca01:~/ChIP_tutorial$ ls -lh\ntotal 3.2G\n-rw-r--r-- 1 mhirst orca_users 958M Oct  4 15:20 Naive_H3K27ac.final.bam\n-rw-r--r-- 1 mhirst orca_users 5.6M Oct  4 15:20 Naive_H3K27ac.final.bam.bai\n-rw-r--r-- 1 mhirst orca_users 815M Oct  4 15:57 Naive_H3K27ac_control_lambda.bdg\n-rw-r--r-- 1 mhirst orca_users 1.1M Oct  4 15:57 Naive_H3K27ac_peaks.narrowPeak\n-rw-r--r-- 1 mhirst orca_users 1.3M Oct  4 15:57 Naive_H3K27ac_peaks.xls\n-rw-r--r-- 1 mhirst orca_users 754K Oct  4 15:57 Naive_H3K27ac_summits.bed\n-rw-r--r-- 1 mhirst orca_users 310M Oct  4 15:57 Naive_H3K27ac_treat_pileup.bdg\n-rw-r--r-- 1 mhirst orca_users 1.1G Oct  4 15:30 Naive_Input.final.bam\n-rw-r--r-- 1 mhirst orca_users 5.8M Oct  4 15:30 Naive_Input.final.bam.bai\n-rw------- 1 mhirst orca_users   58 Oct  4 05:36 nohup.out"},{"path":"chip-seq-analysis.html","id":"final-processing","chapter":"6 ChIP-seq analysis","heading":"6.9 Final Processing","text":"Convert bigWig sort (Orca server).","code":"wget http://hgdownload.cse.ucsc.edu/goldenPath/mm10/bigZips/mm10.chrom.sizes\n\nbedtools sort -i Naive_H3K27ac_treat_pileup.bdg > Naive_H3K27ac_treat_pileup.sort.bdg\nbedtools sort -i Naive_H3K27ac_control_lambda.bdg > Naive_H3K27ac_control_lambda.sort.bdg\n\nbedGraphToBigWig Naive_H3K27ac_treat_pileup.sort.bdg mm10.chrom.sizes Naive_H3K27ac_treat_pileup.sort.bw\nbedGraphToBigWig Naive_H3K27ac_control_lambda.sort.bdg mm10.chrom.sizes Naive_H3K27ac_control_lambda.sort.bw"},{"path":"chip-seq-analysis.html","id":"transfer-all-relevant-output-files-to-your-local-computer","chapter":"6 ChIP-seq analysis","heading":"6.10 Transfer all relevant output files to your local computer","text":"Using different terminal window connected server, retrieve bigWig narrowPeak filesPre-run analysis can found :can replace folder ~/ChIP_tutorial folder script doesn’t finish running time.Launch IGV load bigWigs bed (narrowPeak) files.haven’t installed yet, please get IGV download. Make sure loading Mouse (mm10) reference genome clicking drop-menu top left hand corner (Genomes > Load Genome Server > mm10).CONGRATULATIONS! now completed first ChIP-seq analysis.Questions:files outputted MACS2 represent?Find one H3K27ac peak, either displaying text file terminal looking files IGV. can also use text file file location jump within IGV. chromosomal position?many total peaks called analysis?peaks hand, one downstream analysis step can perform might rely set called peaks?","code":"scp user01@orca1.bcgsc.ca:/home/<user name>/ChIP_tutorial/*{.bw,.narrowPeak} /your/local/folder/projects/micb405/analysis/ChIP_tutorial"},{"path":"chip-seq-analysis.html","id":"additional-resources-3","chapter":"6 ChIP-seq analysis","heading":"Additional resources","text":"Harvard Chan Bioinformatics Core ChIP-seq CoursePeak Calling MACS2","code":""},{"path":"bash-cheat-sheet.html","id":"bash-cheat-sheet","chapter":"A Bash cheat sheet","heading":"A Bash cheat sheet","text":"TABLE .1:  Shell cheat sheetChange directory.. parent directory~ home directory- last visited directoryList files directory-l listLook text filehelp navigationquitCopy files local serverGive file path server <user>@<server address>:<file path>Get list command historyFollow !<number> execute corresponding command -<filename> save history current session text file document workman <command>help <command><command> --helpCreate virtual terminal continues run jobs even connection server terminates-S <session name> create session <session name>-ls list running sessions-r <session name> resume sessionTo leave session keep running, first ctrl+activate commands screen, detach","code":""},{"path":"terminal-keyboard-shortcuts-1.html","id":"terminal-keyboard-shortcuts-1","chapter":"B Terminal keyboard shortcuts","heading":"B Terminal keyboard shortcuts","text":"Terminal keyboard shortcuts","code":""},{"path":"less-and-man-navigation.html","id":"less-and-man-navigation","chapter":"C less and man navigation","heading":"C less and man navigation","text":"less man keyboard shortcutsJump tobeginningor endgshift + g","code":""},{"path":"resources-2.html","id":"resources-2","chapter":"D Resources","heading":"D Resources","text":"OPTIONAL resources want dive course topics depth. tested content appear lecture material.","code":""},{"path":"resources-2.html","id":"unix","chapter":"D Resources","heading":"D.1 Unix","text":"Software Carpentry - UNIX Novice Coursesandbox.bio Online Shell & Tutorials","code":""},{"path":"resources-2.html","id":"r","chapter":"D Resources","heading":"D.2 R","text":"R Data ScienceSoftware Carpentry - Programming RSoftware Carpentry - R Reproducible Scientific Analysis","code":""},{"path":"resources-2.html","id":"bioinformatics","chapter":"D Resources","heading":"D.3 Bioinformatics","text":"Bioinformatics Data Skills (Unix, R, & much, much )","code":""}]
