[{"path":"index.html","id":"about","chapter":"About","heading":"About","text":"Welcome MICB 405 Tutorials website! find tutorials tutorial worksheets uploaded week ahead Friday tutorials.MICB 405 introduces concepts applications sequence-based bioinformatics research across several broad topic areas, including Unix/Linux command line massively parallel sequencing applications. biological perspective, discuss main considerations applications computational tools used subject areas. team projects supplementing lecture materials, work within groups apply bioinformatics tools experimental data sets.Please visit Canvas MICB 405 site syllabus, schedule (via calendar), lectures, module quizzes team project details.","code":""},{"path":"windows-10.html","id":"windows-10","chapter":"Windows 10","heading":"Windows 10","text":"","code":""},{"path":"windows-10.html","id":"updating-the-operating-system","chapter":"Windows 10","heading":"Updating the operating system","text":"DisclaimerIf update upgrade operating system (OS) risk!general, many good reasons update OS. software tools functionality used tutorials work recent OS versions. Updating OS also ensure latest security updates installed help prevent unauthorized access computer.two main reasons prevent updating OS:hardware support updated OS.software depend might work newer OS.Please update latest version Windows 10: version 21H1.\n(Major Windows versions indicate half year released, .e. latest version 21H1 first half—May—2021.)Check current Windows version : Select Windows Start button > Settings > System > > scroll bottom page\nlatest version installed: Select Windows Start button > Settings > Update & Security > Windows Update\nlatest version installed: Select Windows Start button > Settings > Update & Security > Windows UpdateIf Windows Update offer latest version, manually update going Windows 10 Downloads choosing latest version.Windows Update offer latest version, manually update going Windows 10 Downloads choosing latest version.","code":""},{"path":"windows-10.html","id":"accessing-a-terminal-to-connect-with-the-server","chapter":"Windows 10","heading":"Accessing a terminal to connect with the server","text":"instructions ensure local computer can connect Linux server copy files using software tool called OpenSSH.OpenSSH comes pre-installed Windows 10 version 1803 newer. updated latest Windows 10 version, already OpenSSH available . Windows 10 version older update, follow official Microsoft documentation installing OpenSSH Client.OpenSSH comes pre-installed Windows 10 version 1803 newer. updated latest Windows 10 version, already OpenSSH available . Windows 10 version older update, follow official Microsoft documentation installing OpenSSH Client.simplest way access OpenSSH Windows open “Command Prompt” application, discoverable search bar. application provide sufficient functionality server-based work MICB405.simplest way access OpenSSH Windows open “Command Prompt” application, discoverable search bar. application provide sufficient functionality server-based work MICB405., can proceed Tutorial 1., can proceed Tutorial 1.","code":""},{"path":"windows-10.html","id":"additional-considerations-for-windows","chapter":"Windows 10","heading":"Additional considerations for Windows","text":"aware open Command Prompt, using entirely different local shell set commands unique Linux. connected server (using OpenSSH, see ) using Bash. Tread caution executing commands ssh scp tutorials still Command Prompt (.e. connected server).","code":""},{"path":"windows-10.html","id":"optional-windows-subsystem-for-linux","chapter":"Windows 10","heading":"Optional: Windows Subsystem for Linux","text":"can create true Linux environment command line setting Windows Subsystem Linux (WSL). can access Bash virtualized Linux distribution, either directly distribution’s Windows app Command Prompt practice run Linux commands machine without connecting server.","code":""},{"path":"windows-10.html","id":"resources","chapter":"Windows 10","heading":"Resources","text":"version Windows operating system running?Update Windows 10","code":""},{"path":"macos.html","id":"macos","chapter":"macOS","heading":"macOS","text":"","code":""},{"path":"macos.html","id":"updating-the-operating-system-1","chapter":"macOS","heading":"Updating the operating system","text":"DisclaimerIf update upgrade operating system (OS) risk!general, many good reasons update OS. software tools functionality used tutorials work recent OS versions. Updating OS also ensure latest security updates installed help prevent unauthorized access computer.two main reasons prevent updating OS:hardware support updated OS.software depend might work newer OS.Please upgrade latest version macOS, Big Sur.Please upgrade latest version macOS, Big Sur.Check current version macOS. latest version, follow upgrade instructions Apple support page.Check current version macOS. latest version, follow upgrade instructions Apple support page.upgrade latest version, follow instructions find system requirements upgrade latest versions available . need maintain 32-bit compatibility software, upgrade higher macOS 10.14 Mojave.upgrade latest version, follow instructions find system requirements upgrade latest versions available . need maintain 32-bit compatibility software, upgrade higher macOS 10.14 Mojave.","code":""},{"path":"macos.html","id":"accessing-a-terminal-to-connect-with-the-server-1","chapter":"macOS","heading":"Accessing a terminal to connect with the server","text":"macOS come pre-installed Terminal app located /Applications/Utilities/Terminal.app.macOS come pre-installed Terminal app located /Applications/Utilities/Terminal.app., can proceed Tutorial 1., can proceed Tutorial 1.","code":""},{"path":"macos.html","id":"resources-1","chapter":"macOS","heading":"Resources","text":"Find macOS Mac usingHow upgrade macOS Big SurHow get old versions macOS32-bit app compatibility macOS High Sierra 10.13.4 later","code":""},{"path":"linux.html","id":"linux","chapter":"Linux","heading":"Linux","text":"","code":""},{"path":"linux.html","id":"updating-the-operating-system-2","chapter":"Linux","heading":"Updating the operating system","text":"DisclaimerIf update upgrade operating system (OS) risk!general, many good reasons update OS. software tools functionality used tutorials work recent OS versions. Updating OS also ensure latest security updates installed help prevent unauthorized access computer.two main reasons prevent updating OS:hardware support updated OS.software depend might work newer OS.always best practice keep software packages date Linux well.always best practice keep software packages date Linux well.Debian-based (apt) distributions, simple sudo apt update + sudo apt upgrade , commands vary distributions.Debian-based (apt) distributions, simple sudo apt update + sudo apt upgrade , commands vary distributions.","code":""},{"path":"linux.html","id":"accessing-a-terminal-to-connect-with-the-server-2","chapter":"Linux","heading":"Accessing a terminal to connect with the server","text":"Use preferred Terminal app. location may vary depending distribution. GUIs, able find searching “Terminal”.Use preferred Terminal app. location may vary depending distribution. GUIs, able find searching “Terminal”., can proceed Tutorial 1., can proceed Tutorial 1.","code":""},{"path":"r-and-rstudio.html","id":"r-and-rstudio","chapter":"R and RStudio","heading":"R and RStudio","text":"install R RStudio, must administrator privileges machine. Choose version appropriate operating system. can also watch video Mac Windows install (need install R RStudio, none programs mentioned videos). Please also note versions R RStudio video older. Instead, install update latest version supported operating system.","code":""},{"path":"r-and-rstudio.html","id":"install-r","chapter":"R and RStudio","heading":"Install R","text":"Go https://cran.r-project.org/Go https://cran.r-project.org/Choose among “Download Install R” section (“Source Code Platforms”).\nLatest version: 4.1.2\n(macOS Yosemite older: legacy version 3.3.3)Choose among “Download Install R” section (“Source Code Platforms”).Latest version: 4.1.2(macOS Yosemite older: legacy version 3.3.3)Note Mac usersIf M1 (higher) Mac, must install Intel version R (Bioconductor packages installed yet compatible arm64 version).Note usersYou must R installed proceeding next step.","code":""},{"path":"r-and-rstudio.html","id":"install-rstudio","chapter":"R and RStudio","heading":"Install RStudio","text":"Go https://rstudio.com/products/rstudio/download/#downloadGo https://rstudio.com/products/rstudio/download/#downloadSelect FREE Desktop version.Select FREE Desktop version.Choose among “Installers Supported Platforms” section (“Zip/Tarballs”) follow link older versions RStudio need legacy version.\nLatest version: 2021.09.0\n(macOS El Capitan older: legacy version 1.1.463)Choose among “Installers Supported Platforms” section (“Zip/Tarballs”) follow link older versions RStudio need legacy version.Latest version: 2021.09.0(macOS El Capitan older: legacy version 1.1.463)","code":""},{"path":"r-and-rstudio.html","id":"install-r-packages","chapter":"R and RStudio","heading":"Install R packages","text":"Open RStudio, :Select “Console” tab left panel .Copy following code prompt >  install necessary packages:\n\n(!require(tidyverse))    install.packages(\"tidyverse\")\n(!require(pheatmap))     install.packages(\"pheatmap\")\n(!require(RColorBrewer)) install.packages(\"RColorBrewer\")\n(!require(BiocManager))  install.packages(\"BiocManager\")\n(!require(DESeq2))       BiocManager::install(\"DESeq2\")\ninstalling (updating, see ) packages, might prompted:\n  binary version available, source version later:\n\n<table package names>\n\nwant install sources package need compilation? (Yes//cancel)\nAlways enter followed enter.Copy following code prompt >  install necessary packages:installing (updating, see ) packages, might prompted:Always enter followed enter.Update packages selecting “Packages” tab bottom right panel  click “Update” .\nUpdate packages selecting “Packages” tab bottom right panel  click “Update” .packages listed, first click “Select ”  “Install Updates” .\npackages listed, first click “Select ”  “Install Updates” .","code":"\nif (!require(tidyverse))    install.packages(\"tidyverse\")\nif (!require(pheatmap))     install.packages(\"pheatmap\")\nif (!require(RColorBrewer)) install.packages(\"RColorBrewer\")\nif (!require(BiocManager))  install.packages(\"BiocManager\")\nif (!require(DESeq2))       BiocManager::install(\"DESeq2\")  There is a binary version available, but the source version is later:\n\n<table of package names>\n\nDo you want to install from sources the package which need compilation? (Yes/no/cancel)"},{"path":"r-and-rstudio.html","id":"check-that-it-worked","chapter":"R and RStudio","heading":"Check that it worked","text":"","code":""},{"path":"r-and-rstudio.html","id":"troubleshooting","chapter":"R and RStudio","heading":"Troubleshooting","text":"","code":""},{"path":"r-and-rstudio.html","id":"rstudio-looks-incorrect","chapter":"R and RStudio","heading":"RStudio looks incorrect","text":"confirmed RStudio open don’t see panels depicted , RStudio menu bar, select View > Panes > Show panes.","code":""},{"path":"r-and-rstudio.html","id":"my-computer-wont-let-me-open-the-downloaded-files-to-install-them","chapter":"R and RStudio","heading":"My computer won’t let me open the downloaded files to install them","text":"Mac: right-click choose “Open ” > “Installer.app (default)” select “Open” prompted sure want open fileWindows: right-click choose “Run administrator”","code":""},{"path":"r-and-rstudio.html","id":"still-doesnt-work","chapter":"R and RStudio","heading":"Still doesn’t work","text":"Please come one office hours get help.","code":""},{"path":"r-and-rstudio.html","id":"further-resources","chapter":"R and RStudio","heading":"Further resources","text":"Install RR FAQR Installation Administration ManualHow Use RStudioRStudio Public Discussion & Troubleshooting Guide","code":""},{"path":"overview.html","id":"overview","chapter":"Overview","heading":"Overview","text":"","code":""},{"path":"overview.html","id":"formatting","chapter":"Overview","heading":"Formatting","text":"text-paragraphs, code always formatted monospace font surrounded box, like . Longer examples code separate box.many cases output code boxes .Replace placeholder indicated angular brackets <placeholder> code.Pressing Key keyboard formatted like .","code":"First line of code\nSecond line of code\n..."},{"path":"introduction-linux-server-accounts.html","id":"introduction-linux-server-accounts","chapter":"1 Introduction & Linux Server Accounts","heading":"1 Introduction & Linux Server Accounts","text":"Welcome first MICB 405 lab! Today, ’re going get started essential skills tools ’ll using rest course.","code":""},{"path":"introduction-linux-server-accounts.html","id":"slides","chapter":"1 Introduction & Linux Server Accounts","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"introduction-linux-server-accounts.html","id":"logging-in","chapter":"1 Introduction & Linux Server Accounts","heading":"Logging in","text":"followed setup steps opened Command Prompt (Windows) Terminal (macOS, Linux), ready log !Use following command, replacing <username> actual username:Enter password prompted. Don’t worry characters don’t appear - intentional security feature.may respond additonal prompts typing answer (yes) pressing Enter.Let’s break command : ssh command stands “secure shell”. allows users log remote (opposite “local”, computer instance) servers. following text argument. may many arguments separated spaces. <username> mostly obvious, crucially positions shell home directory username server’s system correct permissions. everyone log root (“Administrator” Windows-speak) bad. orca1.bcgsc.ca (everything @) known hostname domain name name device network connected . Super-nerds sometimes replace IP address.","code":"ssh <username>@orca1.bcgsc.ca"},{"path":"introduction-linux-server-accounts.html","id":"bonus","chapter":"1 Introduction & Linux Server Accounts","heading":"Bonus","text":"Review manual pages ls, cd, pwd typing man followed command. Can use move local machine’s folder system find ? Orca server?exit man page, press q.","code":""},{"path":"introduction-linux-server-accounts.html","id":"delve-into-man-pages-and-help","chapter":"1 Introduction & Linux Server Accounts","heading":"Delve into man pages and help","text":"difference man page, --help -h argument added command? use either option? (try commands, look StackExchange ’re confused)difference man page, --help -h argument added command? use either option? (try commands, look StackExchange ’re confused)list Bash commands often used bioinformatics. Look man page least one . think ? Hypothetically, way think used bioinformatics context? arguments handy? Discuss within group!\ngrep\ntr\nawk\nlist Bash commands often used bioinformatics. Look man page least one . think ? Hypothetically, way think used bioinformatics context? arguments handy? Discuss within group!greptrawk","code":""},{"path":"introduction-linux-server-accounts.html","id":"terminal-keyboard-shortcuts","chapter":"1 Introduction & Linux Server Accounts","heading":"Terminal keyboard shortcuts","text":"typing text, can navigate, copy, paste text without using mouse? practice, lot faster.Terminal keyboard shortcuts","code":""},{"path":"introduction-linux-server-accounts.html","id":"advanced","chapter":"1 Introduction & Linux Server Accounts","heading":"Advanced","text":"Create new file running nano testfile.txt home directory local machine (Use ctrl + o save ctrl + x exit nano).","code":""},{"path":"introduction-linux-server-accounts.html","id":"additonal-resources","chapter":"1 Introduction & Linux Server Accounts","heading":"Additonal resources","text":"complete tasks, check page reading practice!!","code":""},{"path":"bash-and-scripting.html","id":"bash-and-scripting","chapter":"2 Bash and scripting","heading":"2 Bash and scripting","text":"","code":""},{"path":"bash-and-scripting.html","id":"slides-1","chapter":"2 Bash and scripting","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"bash-and-scripting.html","id":"exercise-1","chapter":"2 Bash and scripting","heading":"Exercise 1","text":"Write shell script prints Shell Scripting Fun! screen.\nNow modify shell script include variable. variable hold contents message Shell Scripting Fun!.","code":""},{"path":"bash-and-scripting.html","id":"exercise-2","chapter":"2 Bash and scripting","heading":"Exercise 2","text":"Write shell script check see file foobar exists. exist, display \"foobar\" definitely . Next, check see can write file. can, display permissions edit \"foobar\". , display permissions edit \"foobar\".","code":""},{"path":"bash-and-scripting.html","id":"exercise-3","chapter":"2 Bash and scripting","heading":"Exercise 3","text":"Write shell script displays man, bear, pig, dog, cat, sheep screen appearing separate line. Try lines possible .e. repeating commands excessively. Hint: may create “Bash array” words line.","code":""},{"path":"bash-and-scripting.html","id":"exercise-4","chapter":"2 Bash and scripting","heading":"Exercise 4","text":"Write shell script takes name file directory (argument) prints regular file, directory, another type file screen.","code":""},{"path":"bash-and-scripting.html","id":"exercise-5","chapter":"2 Bash and scripting","heading":"Exercise 5","text":"Create script searches files /projects/micb405/data/bordetella/* /projects/micb405/data/bordetella/Full_Run/*following sequenceGCGCGCCTGGGCCCGGGCCTGCCCGCGATCGGCGCGGCGCACGATCAAGGGCATGGCGACATTGTCCAGCGCCGTGAACTCCGGCAGCAGGTGATGGAACTGGTAGACAAAGCCCAGGCTGCGATTGCGCAAGGCGCTCTTGCGGGATTCGGACAGGCCGTCGGCCGAGGTGCCGTCGACCACGACCGAGCCGCTGCTGGGCACATCCAGCAGGCCCAGGATGTGCAGCAGCGTGCTCTTGCCCGACCCCand produces following (similar) output:","code":"ahauduc_mb20@orca01:~$ bash script.bash\nF01_R1.fastq contains the sequence\nF01_R1_1M.fastq does not contain the sequence\nF01_R2.fastq does not contain the sequence\nF01_R2_1M.fastq does not contain the sequence"},{"path":"bash-and-scripting.html","id":"additional-resources","chapter":"2 Bash and scripting","heading":"Additional resources","text":"help, check looping scripting chapters Software Carpentry!","code":""},{"path":"fastqc.html","id":"fastqc","chapter":"3 FastQC","heading":"3 FastQC","text":"","code":""},{"path":"fastqc.html","id":"slides-2","chapter":"3 FastQC","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"fastqc.html","id":"exercise-1-1","chapter":"3 FastQC","heading":"Exercise 1","text":"Navigate /projects/micb405/data/Ebola. see paired-end FASTQ files. Let’s say files just came sequencer, want take quick look ensure nothing went awry sequencing process. ’re interested exact stats, still want take look modules graphical HTML report.Perform FastQC files, outputting results somewhere home directory.Next, scp just HTML files computer. (Hint: remember * refers name file within folder. might modify refer files ending .html?)Now, find transferred pair HTML files computer open web browser choice!","code":""},{"path":"fastqc.html","id":"exercise-2-1","chapter":"3 FastQC","heading":"Exercise 2","text":"Take look different modules FastQC output. Check “Per base sequence quality”, “Per sequence quality scores”, “Per base sequence content” Describe considered acceptable FastQC. “Per base sequence content”, need change FastQC flag module warning?Take look “Per sequence GC content”. went wrong ? shifting distribution mean matched theoretical mean sufficient FastQC flag acceptable?","code":""},{"path":"fastqc.html","id":"bonus-1","chapter":"3 FastQC","heading":"Bonus","text":"Look “Sequence Duplication Levels”. pattern distinct, ’s highly unusual whole-genome sequencing (DNA) run. However, let’s say know sequencing run done perfectly. kind genetic epigenetic material sequenced , rather simple DNA FastQC expects, causes sequences appear many times?Look help page fastp choose one trimming filtering step. Apply filtering Ebola FASTQs output filtered FASTQ directory home directory. run fastqc filtered FASTQs, can observe difference report stemming filtering steps enacted? can also use sandbox play around different fastp parameters!","code":""},{"path":"fastqc.html","id":"additonal-resources-1","chapter":"3 FastQC","heading":"Additonal resources","text":"FastQC tutorial FAQFastQC tutorial FAQFastQC manualFastQC manual","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"working-with-samtools-and-bcftools-part-1","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"4 Working with SAMtools and BCFtools Part 1","text":"","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"slides-3","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"main-exercise","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Main Exercise","text":"Create new SAM file aligning following FASTQ files bordetella reference genome using bwa mem script.\n# FASTA\n/projects/micb405/analysis/references/ASM107827v1/GCA_001078275.1_ASM107827v1_genomic.fna\n\n# FASTQ\n/projects/micb405/data/bordetella/F01_R1_1M.fastq\n/projects/micb405/data/bordetella/F01_R2_1M.fastqCreate new SAM file aligning following FASTQ files bordetella reference genome using bwa mem script.Run samtools flagstat resulting SAM file. different lines mean?Run samtools flagstat resulting SAM file. different lines mean?Next, create script processes resulting SAM indexed, sorted BAM duplicates removed.Next, create script processes resulting SAM indexed, sorted BAM duplicates removed.sorting duplicate removal, “sanity check” step perform output (hint… function within samtools can allow check binary BAM file eye) verify reads sorted (easier), duplicates removed (harder)? looking confirm commands worked intended?sorting duplicate removal, “sanity check” step perform output (hint… function within samtools can allow check binary BAM file eye) verify reads sorted (easier), duplicates removed (harder)? looking confirm commands worked intended?, add line script call variants using bcftools! may take , run happens background check back later?, add line script call variants using bcftools! may take , run happens background check back later?","code":"# FASTA\n/projects/micb405/analysis/references/ASM107827v1/GCA_001078275.1_ASM107827v1_genomic.fna\n\n# FASTQ\n/projects/micb405/data/bordetella/F01_R1_1M.fastq\n/projects/micb405/data/bordetella/F01_R2_1M.fastq"},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"bonus-2","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Bonus","text":"Download reference, bam, bam.bai, vcf.gz, vc.gz.tbi files view IGV viewer. Go one areas marked variant bcftools call. agree “call”?","code":""},{"path":"working-with-samtools-and-bcftools-part-1.html","id":"additional-resources-1","chapter":"4 Working with SAMtools and BCFtools Part 1","heading":"Additional resources","text":"BWA manual pagesSAMtools manual pagesBCFtools manual pagesIntroduction BAM file formatIntroduction VCF file formatIGV downloadIGV user guide","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"working-with-samtools-and-bcftools-part-2","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"5 Working with SAMtools and BCFtools Part 2","text":"","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"slides-4","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"exercise","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"Exercise","text":"Create new alignment using bwa aln.quick comparison using SN metrics samtools stats bwa aln BAM previous bwa mem BAM. one metric changed might ?Filter bwa aln alignment order keep reads mapping quality threshold choice.\nquick side--side comparison coverage new old bwa aln alignments using bwa stats. introducing quality threshold lead difference ? Can explain pros cons filtering mapping quality terms sensitivity specificity?\nChoosing arbitrary area along Bordetella’s single contig, one difference can spot new old bwa aln alignments besides read depth? (Hint: take look bit flags positions, consult IGV’s coloring scheme.)\nquick side--side comparison coverage new old bwa aln alignments using bwa stats. introducing quality threshold lead difference ? Can explain pros cons filtering mapping quality terms sensitivity specificity?Choosing arbitrary area along Bordetella’s single contig, one difference can spot new old bwa aln alignments besides read depth? (Hint: take look bit flags positions, consult IGV’s coloring scheme.)","code":""},{"path":"working-with-samtools-and-bcftools-part-2.html","id":"additional-resources-2","chapter":"5 Working with SAMtools and BCFtools Part 2","heading":"Additional resources","text":"BWA manual pagesSAMtools manual pagesBCFtools manual pagesIntroduction BAM file formatIntroduction VCF file formatIGV downloadIGV user guide","code":""},{"path":"chip-seq-analysis.html","id":"chip-seq-analysis","chapter":"6 ChIP-seq analysis","heading":"6 ChIP-seq analysis","text":"","code":""},{"path":"chip-seq-analysis.html","id":"slides-5","chapter":"6 ChIP-seq analysis","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"chip-seq-analysis.html","id":"setup","chapter":"6 ChIP-seq analysis","heading":"6.1 Setup","text":"Make sure IGV installed laptopMake sure IGV installed laptopCheck macs2 installed $PATH running macs2Check macs2 installed $PATH running macs2If see folder macs2 installed, run:\npip3 install macs2\npip3 install --upgrade numpyIf see folder macs2 installed, run:Set new folder work tutorial:\nmkdir ~/ChIP_tutorial\ncd ~/ChIP_tutorialSet new folder work tutorial:Check files needed tutorial using ls -lh /projects/micb405/data/mouse/chip_tutorial. ChIP-seq reads constitute main input analysis.Check files needed tutorial using ls -lh /projects/micb405/data/mouse/chip_tutorial. ChIP-seq reads constitute main input analysis.","code":"pip3 install macs2\npip3 install --upgrade numpymkdir ~/ChIP_tutorial\ncd ~/ChIP_tutorial"},{"path":"chip-seq-analysis.html","id":"suggested-workflow","chapter":"6 ChIP-seq analysis","heading":"6.2 Suggested workflow","text":"(recommended) tools working complete project include:BWASAMtoolsMACS2IGV (installed computer)","code":""},{"path":"chip-seq-analysis.html","id":"aligning-using-bwa-mem","chapter":"6 ChIP-seq analysis","heading":"6.3 Aligning using BWA-MEM","text":"now process map reads using bwa mem. Note run time command syntax bwa mem different (easier faster) bwa aln introduced class. alignment process take ~20 min complete depending server load. highly recommended construct commands within shell script generated associated log files redirecting STDOUT described class. make subsequent commands easier, remember can define paths commonly used files/resources script shell variables. example, can define path indexed mm10 genome directory tutorial input files stored (see ). Best practice use absolute rather relative path defining variables, ensure script behave similarly matter located filesystem.need export variable want add current shell persist sessions. Since script runs subshell continuous session unique variables, ’s necessary export variables within .now familiar, defined can call paths script/shell entering special character $ followed variable name shown . following command run bwa mem stream sam file samtools view, automatically convert bam file. can use design .Note -t 8 multithreaded processing improve speed. $GENOME specifies location reference genome use. $DATA/Naive_H3K27ac_1.fastq $DATA/Naive_H3K27ac_2.fastq specifies location reads. step take time. Expect program run 20 mins longer depending server load. can add nohup front command, front command running script commands, order assure disconnected server, analysis steps stop.","code":"GENOME=/projects/micb405/analysis/references/mm10/mm10.fa\nDATA=/projects/micb405/data/mouse/chip_tutorial# Input a.k.a. control alignment\nbwa mem \\\n  -t 8 \\\n  $GENOME \\\n  $DATA/Naive_Input_1.fastq \\\n  $DATA/Naive_Input_2.fastq \\\n  | samtools view -h -b - -o Naive_Input.bam\n\n# Treatment a.k.a. immunoprecipitated a.k.a. IP alignment\nbwa mem \\\n  -t 8 \\\n  $GENOME \\\n  $DATA/Naive_H3K27ac_1.fastq \\\n  $DATA/Naive_H3K27ac_2.fastq \\\n  | samtools view -h -b - -o Naive_H3K27ac.bam"},{"path":"chip-seq-analysis.html","id":"check-files","chapter":"6 ChIP-seq analysis","heading":"6.4 Check files","text":"end, something similar :","code":"user01@orca01:~/ChIP_tutorial$ ls -lh\ntotal 8.7G\n-rw-r--r-- 1 mhirst orca_users 1.2G Oct  4 05:33 Naive_H3K27ac.bam\n-rw-r--r-- 1 mhirst orca_users 1.2G Oct  4 05:36 Naive_Input.bam\n-rw------- 1 mhirst orca_users   58 Oct  4 05:36 nohup.out"},{"path":"chip-seq-analysis.html","id":"sort-mark-duplicates-and-index-alignments-using-samtools","chapter":"6 ChIP-seq analysis","heading":"6.5 Sort, mark duplicates, and index alignments using SAMtools","text":"output bwa mem unsorted SAM file. Downstream tools require sorted BAM file input, intermediate step sort index alignment facilitate future steps, similar covered samtools/bcftools tutorial.Repeat treatment file well.","code":"# Tag mates\nsamtools fixmate -m Naive_Input.bam Naive_Input.fixmate.bam\n# Position sort for markdup\nsamtools sort Naive_Input.fixmate.bam -o Naive_Input.fixmate.sort.bam\n# Mark duplicates. Note that you don't have to remove them as this is done by MACS2 automatically\nsamtools markdup -S Naive_Input.fixmate.sort.bam Naive_Input.markdup.bam\n# Sort again\nsamtools sort Naive_Input.markdup.bam -o Naive_Input.final.bam\n# Index BAM\nsamtools index Naive_Input.final.bam"},{"path":"chip-seq-analysis.html","id":"clean-up-intermediate-files","chapter":"6 ChIP-seq analysis","heading":"6.6 Clean-up intermediate files","text":"Now time clean-intermediate files needed downstream, keeping .final.bam files needed MACS2. finished cleaning files working directory ~2.5G total.","code":""},{"path":"chip-seq-analysis.html","id":"call-peaks-using-macs2","chapter":"6 ChIP-seq analysis","heading":"6.7 Call peaks using MACS2","text":"peak calling, necessary sample data set, well control data set. MACS2 offers option perform regular (narrow) broad peak-calling, case, regular peak calling, however instructions similar broad peak-calling just add additional flag --broad command.call peaks sample Naive_H3K27ac.final.bam using Naive_Input.final.bam control (background). sorted, duplicate-marked bam files samples, can perform MACS2 peakcalling like :-t treatment IP (ImmunoPrecipitated) aligned dup-marked bam fileThe -c control INPUT aligned dup-marked bam fileThe -f indicates input file type (BAM paired-end BAMPE case)-g indicates effective genome size (precomputed mm10 provided mm)-n prefix give output filesThe -B indicates program create BedGraph (.bdg) file resultsThe -q FDR cutoff call peaks","code":"macs2 callpeak \\\n  -t Naive_H3K27ac.final.bam \\\n  -c Naive_Input.final.bam \\\n  -f BAMPE \\\n  -g mm \\\n  -n Naive_H3K27ac \\\n  -B \\\n  -q 0.01"},{"path":"chip-seq-analysis.html","id":"check-files-1","chapter":"6 ChIP-seq analysis","heading":"6.8 Check files","text":"end, something similar :","code":"user01@orca01:~/ChIP_tutorial$ ls -lh\ntotal 3.2G\n-rw-r--r-- 1 mhirst orca_users 958M Oct  4 15:20 Naive_H3K27ac.final.bam\n-rw-r--r-- 1 mhirst orca_users 5.6M Oct  4 15:20 Naive_H3K27ac.final.bam.bai\n-rw-r--r-- 1 mhirst orca_users 815M Oct  4 15:57 Naive_H3K27ac_control_lambda.bdg\n-rw-r--r-- 1 mhirst orca_users 1.1M Oct  4 15:57 Naive_H3K27ac_peaks.narrowPeak\n-rw-r--r-- 1 mhirst orca_users 1.3M Oct  4 15:57 Naive_H3K27ac_peaks.xls\n-rw-r--r-- 1 mhirst orca_users 754K Oct  4 15:57 Naive_H3K27ac_summits.bed\n-rw-r--r-- 1 mhirst orca_users 310M Oct  4 15:57 Naive_H3K27ac_treat_pileup.bdg\n-rw-r--r-- 1 mhirst orca_users 1.1G Oct  4 15:30 Naive_Input.final.bam\n-rw-r--r-- 1 mhirst orca_users 5.8M Oct  4 15:30 Naive_Input.final.bam.bai\n-rw------- 1 mhirst orca_users   58 Oct  4 05:36 nohup.out"},{"path":"chip-seq-analysis.html","id":"final-processing","chapter":"6 ChIP-seq analysis","heading":"6.9 Final Processing","text":"Convert bigWig sort (Orca server).","code":"wget http://hgdownload.cse.ucsc.edu/goldenPath/mm10/bigZips/mm10.chrom.sizes\n\nbedtools sort -i Naive_H3K27ac_treat_pileup.bdg > Naive_H3K27ac_treat_pileup.sort.bdg\nbedtools sort -i Naive_H3K27ac_control_lambda.bdg > Naive_H3K27ac_control_lambda.sort.bdg\n\nbedGraphToBigWig Naive_H3K27ac_treat_pileup.sort.bdg mm10.chrom.sizes Naive_H3K27ac_treat_pileup.sort.bw\nbedGraphToBigWig Naive_H3K27ac_control_lambda.sort.bdg mm10.chrom.sizes Naive_H3K27ac_control_lambda.sort.bw"},{"path":"chip-seq-analysis.html","id":"transfer-all-relevant-output-files-to-your-local-computer","chapter":"6 ChIP-seq analysis","heading":"6.10 Transfer all relevant output files to your local computer","text":"Using different terminal window connected server, retrieve bigWig narrowPeak filesPre-run analysis can found :can replace folder ~/ChIP_tutorial folder script doesn’t finish running time.Launch IGV load bigWigs bed (narrowPeak) files.haven’t installed yet, please get IGV download. Make sure loading Mouse (mm10) reference genome clicking drop-menu top left hand corner (Genomes > Load Genome Server > mm10).CONGRATULATIONS! now completed first ChIP-seq analysis.Questions:files outputted MACS2 represent?Find one H3K27ac peak, either displaying text file terminal looking files IGV. can also use text file file location jump within IGV. chromosomal position?many total peaks called analysis?peaks hand, one downstream analysis step can perform might rely set called peaks?","code":"scp user01@orca1.bcgsc.ca:/home/<user name>/ChIP_tutorial/*{.bw,.narrowPeak} /your/local/folder/projects/micb405/analysis/ChIP_tutorial"},{"path":"chip-seq-analysis.html","id":"additional-resources-3","chapter":"6 ChIP-seq analysis","heading":"Additional resources","text":"Harvard Chan Bioinformatics Core ChIP-seq CoursePeak Calling MACS2","code":""},{"path":"rna-seq-alignment-with-star.html","id":"rna-seq-alignment-with-star","chapter":"7 RNA-seq alignment with STAR","heading":"7 RNA-seq alignment with STAR","text":"","code":""},{"path":"rna-seq-alignment-with-star.html","id":"slides-6","chapter":"7 RNA-seq alignment with STAR","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"rna-seq-alignment-with-star.html","id":"star-workflow","chapter":"7 RNA-seq alignment with STAR","heading":"7.1 STAR workflow","text":"Normally, can download mouse genomic data (case, mm10 FASTA GTF files) Ensembl, prepared advance /projects/micb405/analysis/STAR_tutorial. Simply create new working directory subdirectory STAR index.\nmkdir ~/star && cd ~/star\nmkdir STARIndexNormally, can download mouse genomic data (case, mm10 FASTA GTF files) Ensembl, prepared advance /projects/micb405/analysis/STAR_tutorial. Simply create new working directory subdirectory STAR index.begin alignment, STAR must generate format index based genomic information provide . Generate STAR index based mm10 FASTA GTF files, proceed Step 3 runs:\nSTAR \\\n  --runMode genomeGenerate \\\n  --genomeDir STARIndex \\\n  --genomeFastaFiles /projects/micb405/analysis/STAR_tutorial/Mus_musculus.GRCm38.dna.primary_assembly.fa \\\n  --sjdbGTFfile /projects/micb405/analysis/STAR_tutorial/Mus_musculus.GRCm38.84.gtf \\\n  --sjdbOverhang 49 \\\n  --runThreadN 16Before begin alignment, STAR must generate format index based genomic information provide . Generate STAR index based mm10 FASTA GTF files, proceed Step 3 runs:Download healthy tissue RNAseq FASTQ files paper “RNA-Seq atlas gene expression mouse rat normal tissues”. located associated ArrayExpress can located data citations article’s NCBI page.\nDiscuss among group idea investigate given data available. Download FASTQ files allow accomplish . Recall RNA-seq indicate relative expression gene intervals provide, can later quantified normalized HTseq & DESeq2.\n# case, downloading 4 tissue types first individual mouse order observe differential gene expression areas.\n# just example! \nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/000/ERR2130640/ERR2130640.fastq.gz\nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/009/ERR2130649/ERR2130649.fastq.gz\nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/003/ERR2130623/ERR2130623.fastq.gz\nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/004/ERR2130614/ERR2130614.fastq.gzDownload healthy tissue RNAseq FASTQ files paper “RNA-Seq atlas gene expression mouse rat normal tissues”. located associated ArrayExpress can located data citations article’s NCBI page.Discuss among group idea investigate given data available. Download FASTQ files allow accomplish . Recall RNA-seq indicate relative expression gene intervals provide, can later quantified normalized HTseq & DESeq2.STAR index ready, run STAR, outputting separate directory sample wish align. can control output directory string provided --outFileNamePrefix. directories created beforehand - STAR create directories . Since won’t time whole process run today, create script runs STAR command samples run way won’t stop exit shell (Group Assignment part #2 ).\nsure --readFilesIn, --outFileNamePrefix, --outSAMattrRGline changes samples\nSTAR \\\n  --genomeDir STARIndex/ \\\n  --readFilesIn sample1.fastq.gz \\\n  --outFileNamePrefix sample1/sample1.fastq.gz \\\n  --runThreadN 8 \\\n  --limitBAMsortRAM 60000000000 \\\n  --outSAMattrRGline ID:sample1.fastq.gz SM:sample1.fastq.gz \\\n  --outBAMsortingThreadN 8 \\\n  --outSAMtype BAM SortedByCoordinate \\\n  --outSAMunmapped Within \\\n  --outSAMstrandField intronMotif \\\n  --readFilesCommand zcat \\\n  --chimSegmentMin 20 \\\n  --genomeLoad NoSharedMemoryWhen STAR index ready, run STAR, outputting separate directory sample wish align. can control output directory string provided --outFileNamePrefix. directories created beforehand - STAR create directories . Since won’t time whole process run today, create script runs STAR command samples run way won’t stop exit shell (Group Assignment part #2 ).sure --readFilesIn, --outFileNamePrefix, --outSAMattrRGline changes samples","code":"mkdir ~/star && cd ~/star\nmkdir STARIndexSTAR \\\n  --runMode genomeGenerate \\\n  --genomeDir STARIndex \\\n  --genomeFastaFiles /projects/micb405/analysis/STAR_tutorial/Mus_musculus.GRCm38.dna.primary_assembly.fa \\\n  --sjdbGTFfile /projects/micb405/analysis/STAR_tutorial/Mus_musculus.GRCm38.84.gtf \\\n  --sjdbOverhang 49 \\\n  --runThreadN 16# In my case, I'm downloading 4 tissue types from the first individual mouse in order to observe differential gene expression in these areas.\n# These are just an example! \nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/000/ERR2130640/ERR2130640.fastq.gz\nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/009/ERR2130649/ERR2130649.fastq.gz\nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/003/ERR2130623/ERR2130623.fastq.gz\nwget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR213/004/ERR2130614/ERR2130614.fastq.gzSTAR \\\n  --genomeDir STARIndex/ \\\n  --readFilesIn sample1.fastq.gz \\\n  --outFileNamePrefix sample1/sample1.fastq.gz \\\n  --runThreadN 8 \\\n  --limitBAMsortRAM 60000000000 \\\n  --outSAMattrRGline ID:sample1.fastq.gz SM:sample1.fastq.gz \\\n  --outBAMsortingThreadN 8 \\\n  --outSAMtype BAM SortedByCoordinate \\\n  --outSAMunmapped Within \\\n  --outSAMstrandField intronMotif \\\n  --readFilesCommand zcat \\\n  --chimSegmentMin 20 \\\n  --genomeLoad NoSharedMemory"},{"path":"rna-seq-alignment-with-star.html","id":"group-assignment","chapter":"7 RNA-seq alignment with STAR","heading":"7.2 Group assignment","text":"samples paper choose, want test ?Create script performs STAR alignment files, avoiding excessive repetition, can run interrupted close connection server.","code":""},{"path":"rna-seq-alignment-with-star.html","id":"resources-2","chapter":"7 RNA-seq alignment with STAR","heading":"7.3 Resources","text":"STAR documentation","code":""},{"path":"htseq-and-deseq2.html","id":"htseq-and-deseq2","chapter":"8 HTSeq and DESeq2","heading":"8 HTSeq and DESeq2","text":"","code":""},{"path":"htseq-and-deseq2.html","id":"slides-7","chapter":"8 HTSeq and DESeq2","heading":"Slides","text":"can download slides tutorial .","code":""},{"path":"htseq-and-deseq2.html","id":"overview-1","chapter":"8 HTSeq and DESeq2","heading":"8.1 Overview","text":"tutorial, use DESeq2 analyze RNA-Seq data. tutorial covers :Use HTSeq data generated .Use HTSeq data generated .Load counts new data () R.Load counts new data () R.Set controls DESeq2 changing factor levels.Set controls DESeq2 changing factor levels.Run sanity checks ensure results make biological sense.Run sanity checks ensure results make biological sense.Filter differential expression tables Padj Log2 fold change.Filter differential expression tables Padj Log2 fold change.","code":""},{"path":"htseq-and-deseq2.html","id":"htseq-overview","chapter":"8 HTSeq and DESeq2","heading":"8.2 HTSeq Overview","text":"Normally, use HTSeq create count files STAR alignments produced, using following code:…repeat every sample.However, due constraints time available disk space server, downloading existing count data experiment containing six samples grouped control treatment categories.","code":"pip3 install htseq\n\nhtseq-count \\\n  <sample_id>/<sample_id>.fastq.gzAligned.sortedByCoord.out.bam \\\n  Mus_musculus.GRCm38.84.gtf \\\n  -f bam \\\n  -r pos \\\n  --stranded=no \\\n  > <sample_id>.htseq.out"},{"path":"htseq-and-deseq2.html","id":"deseq2","chapter":"8 HTSeq and DESeq2","heading":"8.3 DESeq2","text":"","code":""},{"path":"htseq-and-deseq2.html","id":"setup-1","chapter":"8 HTSeq and DESeq2","heading":"8.3.1 Setup","text":"data tutorial located Orca1 server /projects/micb405/resources/DESeq2_tutorial. Use scp copy entire directory computer move directory keep MICB405 files.Open RStudio create new R project (File > New Project).Since want DESeq2 tutorial materials together, click ‘Existing Directory’ choose DESeq2_tutorial directory copied server.","code":"scp -r <username>@orca1.bcgsc.ca:/projects/micb405/resources/DESeq2_tutorial ."},{"path":"htseq-and-deseq2.html","id":"scripting-in-r","chapter":"8 HTSeq and DESeq2","heading":"8.3.2 Scripting in R","text":"One critical aspects bioinformatics ensuring code easy read well documented. means organize scripts use comments split code different sections.","code":""},{"path":"htseq-and-deseq2.html","id":"setting-up-your-script","chapter":"8 HTSeq and DESeq2","heading":"8.3.2.1 Setting up your script","text":"always begin R script simple header:next step R script load packages plan use:sure install packages installed previously laptop.DESeq2 need downloaded BiocManager:","code":"\n# Your name\n# Title of your script (e.g. MICB405 DESeq2 tutorial)\n# Date of your last update\nlibrary(DESeq2)\nlibrary(tidyverse)\nlibrary(pheatmap)\nlibrary(RColorBrewer)"},{"path":"htseq-and-deseq2.html","id":"loading-data","chapter":"8 HTSeq and DESeq2","heading":"8.3.2.2 Loading data","text":"best practice collect input files folder (often called “data”) files loaded overwritten.Since multiple input files, can use R generate paths files want open automatically. data files directory, save us typing, can assign path directory variable.filename generated sample name common suffix. get vector sample names, can use samples.csv metadata file, also need assign conditions samples. work projects, enter filenames corresponding conditions CSV file.can see, metadata two columns: sample names conditions. can generate filenames sample_metadata$sample element vector (e.g. first element \"control_1\") adding directory \"data\" prefix \".htseq.\" suffix., quick test, can run (file.exists(files)), return TRUE console file paths correct. First, files.exists(files) checks filename files file exists returns TRUE FALSE, resulting logical vector. files present, elements logical vector TRUE.function () returns TRUE elements logical vector TRUE.","code":"\ndir <- \"data\"\n#  file.path constructs filepath with the correct separator dependent of OS\nsample_metadata <- read_csv(file.path(dir, \"samples.csv\"))\nsample_metadata## # A tibble: 6 × 2\n##   sample    condition\n##   <chr>     <chr>    \n## 1 control_1 control  \n## 2 control_2 control  \n## 3 control_3 control  \n## 4 treat_1   treatment\n## 5 treat_2   treatment\n## 6 treat_3   treatment\n#  paste0 appends (i.e. adds together) character objects\nfiles <- paste0(file.path(dir, sample_metadata$sample), \".htseq.out\")\nfiles## [1] \"data/control_1.htseq.out\" \"data/control_2.htseq.out\"\n## [3] \"data/control_3.htseq.out\" \"data/treat_1.htseq.out\"  \n## [5] \"data/treat_2.htseq.out\"   \"data/treat_3.htseq.out\"\nfile.exists(files)## [1] TRUE TRUE TRUE TRUE TRUE TRUE\nall(file.exists(files))## [1] TRUE"},{"path":"htseq-and-deseq2.html","id":"running-deseq2","chapter":"8 HTSeq and DESeq2","heading":"8.3.3 Running DESeq2","text":"DESeq2 requires data shape SummarizedExperiment object. Since reshaping input data code complicated, functions within DESeq2 specific source counts file, prepare data use DESeq2. Since using HTSeq generate counts data class, function need called DESeqDataSetFromHTSeqCount(). One required arguments sampleTable, must provide data table columns sampleName, fileName, independent variables changed experiment (e.g. sex, treatment, tissue). purpose, can quickly build sample_df loaded metadata sample_metadata vector file paths files defined earlier.required argument DESeqDataSetFromHTSeqCount() design. design argument formula designated tilde symbol ~ identifies independent variable(s) want investigate. data, single independent variable, .e. condition. Experiments multifactorial experimental design lot complicated investigate.DESeq data set, design variables stored factor (data type R), default organized alphabetically. Without information, DESeq2 use condition comes first alphabetically reference. using \"treated\" \"untreated\", example, DESeq2 incorrectly assume \"treated\" samples reference. prevent confusion, can set name used reference explicitly argument ref inside relevel() function.Now reference level set, can run DESeq2 dataset.","code":"\n# Creates a new data table with the variables sampleName, fileName and condition\nsample_df <- data.frame(sampleName = sample_metadata$sample,\n                        fileName = files,\n                        condition = sample_metadata$condition)\n\nddsHTSeq <- DESeqDataSetFromHTSeqCount(sampleTable = sample_df,\n                                       design = ~ condition)\n## Set control condition using the relevel function\nddsHTSeq$condition <- relevel(ddsHTSeq$condition, ref = \"control\")\ndds <- DESeq(ddsHTSeq)"},{"path":"htseq-and-deseq2.html","id":"sample-clustering","chapter":"8 HTSeq and DESeq2","heading":"8.3.4 Sample Clustering","text":"distribution RNA Seq data highly skewed, high abundance genes many low abundance genes, helpful transform data visualize clustering. DESeq2 comes function rlog(), log-transforms count data. transformation, can use PCA identify samples similar group one independent variables (case, single variable can take “control” “treated”).distance matrix another way examine samples cluster. code chunk calculates distances sample maps colour palette (defined colorRampPalette) onto similar samples display darker colours.samples don’t cluster together like expect , check batch effects.","code":"\nrld <- rlog(dds)\nplotPCA(rld, intgroup = \"condition\")\nsample_dists <- dist(t(assay(rld)))\nsample_dist_matrix <- as.matrix(sample_dists)\ncolnames(sample_dist_matrix) <- NULL\ncolours <- colorRampPalette(rev(brewer.pal(9, \"Blues\")))(255)\npheatmap(sample_dist_matrix,\n         clustering_distance_rows = sample_dists,\n         clustering_distance_cols = sample_dists, \n         col = colours)"},{"path":"htseq-and-deseq2.html","id":"filtering-and-data-export","chapter":"8 HTSeq and DESeq2","heading":"8.3.5 Filtering and data export","text":"Since samples cluster according independent variable, can move forward analysis. examine results, can save global environment. DESeq2 calculates results combinations levels experimental design. resultsNames() function tells us name result DESeq2 calculated, can choose one look specifying “name =” results(). results() function output matrix genes, including similar differential expression two conditions.Since interested differentially expressed genes, can use subset() function base R keep results adjusted p-value < 0.05 save results CSV file.want information DESeq2, can access package vignette running:Now distance matrix list significant genes, one downstream analysis inform biological difference two treatment groups?","code":"\nresultsNames(dds)## [1] \"Intercept\"                      \"condition_treatment_vs_control\"\nres <- results(dds, name = \"condition_treatment_vs_control\")\nhead(res)## log2 fold change (MLE): condition treatment vs control \n## Wald test p-value: condition treatment vs control \n## DataFrame with 6 rows and 6 columns\n##                      baseMean log2FoldChange     lfcSE       stat      pvalue\n##                     <numeric>      <numeric> <numeric>  <numeric>   <numeric>\n## ENSMUSG00000000001 299.611431       -1.15529 0.0952683 -12.126645 7.63122e-34\n## ENSMUSG00000000003   0.217348        1.75589 4.0804729   0.430316 6.66966e-01\n## ENSMUSG00000000028  10.401452        1.75564 0.5135561   3.418600 6.29442e-04\n## ENSMUSG00000000031   0.000000             NA        NA         NA          NA\n## ENSMUSG00000000037   2.760919        2.66847 1.1572396   2.305895 2.11165e-02\n## ENSMUSG00000000049   0.900647        1.37848 2.6339604   0.523348 6.00732e-01\n##                           padj\n##                      <numeric>\n## ENSMUSG00000000001 3.52493e-32\n## ENSMUSG00000000003          NA\n## ENSMUSG00000000028 3.32121e-03\n## ENSMUSG00000000031          NA\n## ENSMUSG00000000037 6.23462e-02\n## ENSMUSG00000000049          NA\nsignificant_res <- subset(res, padj < 0.05)\nwrite.csv(as.data.frame(significant_res), file = \"treat_vs_control_05.csv\")\nvignette(\"DESeq2\")"},{"path":"htseq-and-deseq2.html","id":"additional-resources-4","chapter":"8 HTSeq and DESeq2","heading":"8.4 Additional resources","text":"Original paper: RNA-Seq atlas gene expression mouse rat normal tissuesData source original paperSTAR documentationHTSeq-count documentationDESeq2 vignette","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"introduction-to-r-and-rstudio","chapter":"9 Introduction to R and RStudio","heading":"9 Introduction to R and RStudio","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"slides-8","chapter":"9 Introduction to R and RStudio","heading":"9.1 Slides","text":"can download slides tutorial .","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"learning-outcomes","chapter":"9 Introduction to R and RStudio","heading":"9.2 Learning outcomes","text":"end tutorial able :Identify different components RStudio.Declare variables R.Identify common data types structures used R.Recognize use functions.Install load R packages.Interpret documentation functions packages.R RStudio installed. Please open RStudio work along examples.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"a-tour-of-rstudio","chapter":"9 Introduction to R and RStudio","heading":"9.3 A Tour of RStudio","text":"start RStudio, see something like following window appear:Notice window three “panes”:Console (lower left side): view R engine. can type R commands see output printed R. (tell apart, input blue, output black.) several editing conveniences available: use arrow keys go back previously entered commands, can edit re-run; TAB completing name cursor; see online docs.Console (lower left side): view R engine. can type R commands see output printed R. (tell apart, input blue, output black.) several editing conveniences available: use arrow keys go back previously entered commands, can edit re-run; TAB completing name cursor; see online docs.Environment/History (tabbed upper right): view current user-defined objects previously-entered commands, respectively.Environment/History (tabbed upper right): view current user-defined objects previously-entered commands, respectively.Files/Help/Plots/Packages (tabbed lower right): names suggest, can view contents current directory, built-help pages, graphics created, well manage R packages.Files/Help/Plots/Packages (tabbed lower right): names suggest, can view contents current directory, built-help pages, graphics created, well manage R packages.change look RStudio, can go Tools > Global Options > Appearance select colours, font size, etc. plan working longer periods, suggest choosing dark background colour scheme save computer battery eyes.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"setup-2","chapter":"9 Introduction to R and RStudio","heading":"9.4 Setup","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"rstudio-projects","chapter":"9 Introduction to R and RStudio","heading":"9.4.1 RStudio Projects","text":"Projects great feature RStudio. create project, RStudio creates .Rproj file links files outputs project directory. import data file, R automatically looks project directory instead specify full file path computer. R also automatically saves output project directory. Finally, projects allow save R environment .RData close RStudio re-open , can start right left without re-importing data re-calculating intermediate steps.RStudio simple interface create switch projects, accessed button top-right corner RStudio window. (Labeled “Project: (None)”, initially.)Let’s create project work tutorial. Start choosing menu File > New Project. Select “New Project”, following appear:Choose “New Directory” followed “New Project” click “Browse…”. Navigate Desktop, name directory deseq project.project created, navigate directory using Finder (macOS) File Explorer (Windows). see deseq.Rproj file created.can open project future one three ways:file browser (e.g. Finder Explorer), simply double-click deseq.Rproj file.open RStudio window, choose File > Open Project.Switch among projects clicking R project symbol upper left corner RStudio.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"r-packages","chapter":"9 Introduction to R and RStudio","heading":"9.4.2 R packages","text":"R packages units shareable code, containing functions facilitate enhance analyses. simpler terms, think R packages iPhone Applications. App specific capabilities can accessed install open application. holds true R packages. use functions contained specific R package, first need install package, time want use package need “open” package loading .installing packages might prompted:Always enter followed enter.following tutorials, using tidyverse, pheatmap, BiocManager, DESeq2 packages. tidyverse contains versatile set functions designed easy manipulation data. pheatmap visualizes gene expression levels groups genes similar patterns across treatments. BiocManager allows us install packages Bioconductor platform (see ). Finally, DESeq2 compares gene expression across treatments.packages distributed two different platforms, CRAN (Comprehensive R Archive Network) Bioconductor (think platforms two different app stores R packages).","code":"  There is a binary version available but the source version is later:\n\n<table of package names>\n\nDo you want to install from sources the package which needs compilation? (Yes/no/cancel)"},{"path":"introduction-to-r-and-rstudio.html","id":"installing-packages-from-cran","chapter":"9 Introduction to R and RStudio","heading":"9.4.2.1 Installing Packages from CRAN","text":"Packages CRAN (Comprehensive R Archive Network) can installed function install.packages().","code":"\ninstall.packages(c(\"tidyverse\", \"pheatmap\", \"BiocManager\"))"},{"path":"introduction-to-r-and-rstudio.html","id":"installing-packages-from-bioconductor","chapter":"9 Introduction to R and RStudio","heading":"9.4.2.2 Installing packages from Bioconductor","text":"Bioconductor specializes distributing R packages analysis high-throughput genomic data. Unfortunately, install.packages() limited installing packages CRAN install Bioconductor. Luckily, can download package BiocManager CRAN turn provides interface access packages Bioconductor.first example using function provided package. many situation, just want use single function single time coding session. can access function calling <package>::<function>(). concrete example, can use install() function BiocManager using BiocManager::install() install Bioconductor package.","code":"\nBiocManager::install(\"DESeq2\")"},{"path":"introduction-to-r-and-rstudio.html","id":"loading-packages","chapter":"9 Introduction to R and RStudio","heading":"9.4.2.3 Loading packages","text":"sometimes use functions package multiple times. access package’s functions every time open new RStudio session, need first load (open) packages want use library() function.Packages can loaded like :","code":"\nlibrary(tidyverse)"},{"path":"introduction-to-r-and-rstudio.html","id":"r-scripts","chapter":"9 Introduction to R and RStudio","heading":"9.4.3 R Scripts","text":"R script files primary way R facilitates reproducible research. contain code loads raw data, cleans , performs analyses, creates saves visualizations. R scripts maintain record everything done raw data reach final result. way, easy write communicate methods document listing precise steps used conduct analyses. one R’s primary advantages compared traditional tools like Excel, may unclear reproduce results.Generally, testing operation (e.g. data look like applied log-transformation ?), console (left pane RStudio). committing step analysis (e.g. want apply log-transformation data conduct rest analyses log-transformed data), add R script saved future use.Additionally, annotate R scripts comments. line code, text preceded # symbol execute. Comments can useful remind tell readers specific chunk code .Let’s create R script (File > New File > R Script) save deseq.R deseq project directory. look project directory computer, see deseq.R now saved .can copy paste previous library() commands tutorial aggregate R script.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"data-types","chapter":"9 Introduction to R and RStudio","heading":"9.5 Data types","text":"working data R, might noticed data , different forms data called data types. part tutorial, encounter three basic data types:Let’s look examples different data types. simple example type character. Character types always enclosed quotes.example numeric:important use correct data type function operations R. example, operator + works numeric databut character dataLogicals can take either TRUE FALSE. might already encountered values arguments functions.","code":"\nsalutation <- \"Hello, World!\"\nsalutation## [1] \"Hello, World!\"\nsome_number <- 6\nsome_number## [1] 6\n6 + 2## [1] 8\n\"6\" + \"2\"## Error in \"6\" + \"2\": non-numeric argument to binary operator\nmicrobiology_is_awesome <- TRUE\nmicrobiology_is_awesome## [1] TRUE"},{"path":"introduction-to-r-and-rstudio.html","id":"functions","chapter":"9 Introduction to R and RStudio","heading":"9.6 Functions","text":"Functions one basic units programming. Generally speaking, function takes input generates output. Every R function follows basic syntax, function() name function arguments different parameters can specify (.e. input):function(argument1 = ..., argument2 = ..., ...)can treat functions black box necessarily need know works hood long provided input conforms specific shape.example, function sum() expects numbers:instead pass text arguments sum() receive error:Sometimes, want confirm data type (see ) variable, can using typeof() function.","code":"\nsum(3, 5, 9, 18)## [1] 35\nsum(\"Sum\", \"does\", \"not\", \"accept\", \"text!\")## Error in sum(\"Sum\", \"does\", \"not\", \"accept\", \"text!\"): invalid 'type' (character) of argument\ntypeof(microbiology_is_awesome)## [1] \"logical\""},{"path":"introduction-to-r-and-rstudio.html","id":"getting-help","chapter":"9 Introduction to R and RStudio","heading":"9.7 Getting Help","text":"","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"the-help-function","chapter":"9 Introduction to R and RStudio","heading":"9.7.1 The help function","text":"can get help function R inputting ?function_name Console. function part package, need load package first (.e. library()). open window bottom right Help tab information function, including input options example code.Description section tells us read_delim() general case function used, read_csv(), read_tsv().Usage section tells us inputs need specified default inputs read_delim:file delim need specified default value (.e. followed =).parameters followed = value default (e.g. quote = \"\\\") specified run function.Reading technical documentation can confusing first. can helpful first focus arguments function provided .Arguments Section describes requirements input argument detail.Examples Section examples function can directly copy pasted terminal ran.can also get description package , example ?tidyverse. bottom find link index often provide links documentation.","code":"\n?read_delim"},{"path":"introduction-to-r-and-rstudio.html","id":"vignettes","chapter":"9 Introduction to R and RStudio","heading":"9.7.2 Vignettes","text":"lot packages also provide long-form guide called vignette functionality often giving examples use-cases information methods used. can browse vignettes browseVignettes() get vignette particular package browseVignettes(\"<package name>\") (replace <package name> name package).Help log() functionUsing help identify necessary arguments log() function, compute natural logarithm 4, base 2 logarithm 4, base 4 logarithm 4.never used function inner_join() dplyr package . Take look help documentation inner_join() RStudio (Hint: can look documentation functions packages loaded). list , identify arguments function mandatory specified .xybycopysuffixkeepWhat data type accepted keep argument?","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"data-structures","chapter":"9 Introduction to R and RStudio","heading":"9.8 Data structures","text":"data types R elements build complex objects called data structures. basic structures vector, lists, matrix data frame.","code":""},{"path":"introduction-to-r-and-rstudio.html","id":"vector","chapter":"9 Introduction to R and RStudio","heading":"9.8.1 Vector","text":"can use c() function create vector. vector elements data type (-called atomic vector).CoercionSince vector elements type, happens use c() dissimilar ones? test R’s behaviour, create several vectors possible pairwise combinations character, numeric (use integer), logical, determine type object using typeof(<vector>). addition, test combination () logical either numbers 0 1 (b) logical integer larger 1 smaller -1.behaviour observe called coercion. think particular set behaviours selected design R?can also assign element name using <name> = <value>","code":"\nvector_example <- c(\"This\", \"vector\", \"has\", \"5\", \"elements!\")\nvector_example## [1] \"This\"      \"vector\"    \"has\"       \"5\"         \"elements!\"\nvector_example <- c(first = \"Hi\", second = \"there\")\nvector_example##   first  second \n##    \"Hi\" \"there\""},{"path":"introduction-to-r-and-rstudio.html","id":"list","chapter":"9 Introduction to R and RStudio","heading":"9.8.2 List","text":"R, list special kind vector whose elements can combination objects (.e. also ).can also assign name elements list.","code":"\nlist_example <- list(c(\"gene_a\", \"gene_b\"),\n                     c(\"untreated\", \"control\"))\nlist_example <- list(gene_names = c(\"gene_a\", \"gene_b\"),\n                     treatments = c(\"untreated\", \"control\"))"},{"path":"introduction-to-r-and-rstudio.html","id":"matrix","chapter":"9 Introduction to R and RStudio","heading":"9.8.3 Matrix","text":"data provided vector matrix() filled either column- row-wise matrix. Rows columns can also assigned names.","code":"\nmatrix_example <- matrix(\n  data = c(\n    10, 20,\n    3,  6\n  ),\n  byrow = TRUE,\n  ncol = 2,\n  dimnames = list(\n    c(\"gene_a\", \"gene_b\"),\n    c(\"control\", \"treated\")\n  )\n)\n\nmatrix_example##        control treated\n## gene_a      10      20\n## gene_b       3       6"},{"path":"introduction-to-r-and-rstudio.html","id":"data-frame","chapter":"9 Introduction to R and RStudio","heading":"9.8.4 Data frame","text":"data frame another data structure contains elements columns rows list vectors, column one vector single data type data type may differ among vectors. Data frames big part working data R. Data always provided column <column name> = <data>Although data frame matrix conain information, class object. can determine class class().","code":"\ndata_frame_example <- data.frame(\n  gene_name = c(\"gene_a\", \"gene_b\"),\n  control = c(10, 3),\n  treated = c(20, 3)\n)\n\ndata_frame_example##   gene_name control treated\n## 1    gene_a      10      20\n## 2    gene_b       3       3\nclass(matrix_example)## [1] \"matrix\" \"array\"\nclass(data_frame_example)## [1] \"data.frame\""},{"path":"introduction-to-r-and-rstudio.html","id":"subsetting","chapter":"9 Introduction to R and RStudio","heading":"9.8.5 Subsetting","text":"often want use part data subset accordingly. base R, subsetting done brackets [ ]. example, vector can subset index name position.Matrices data frames can also subset way first specifying rows columns [<rows>, <columns>].can extract single column (vector) data frame using $ operator.","code":"\nvector_example[1]## first \n##  \"Hi\"\nvector_example[\"first\"]## first \n##  \"Hi\"\nmatrix_example[,  \"control\"]## gene_a gene_b \n##     10      3\nmatrix_example[1, \"control\"]## [1] 10\ndata_frame_example[, \"control\"]## [1] 10  3\ndata_frame_example$control## [1] 10  3"},{"path":"deseq2-count-normalization.html","id":"deseq2-count-normalization","chapter":"10 DESeq2: count normalization","heading":"10 DESeq2: count normalization","text":"tutorial use many tools found tidyverse package reproduce DESeq2 calculates size factors normalize count data.","code":""},{"path":"deseq2-count-normalization.html","id":"slides-9","chapter":"10 DESeq2: count normalization","heading":"10.1 Slides","text":"can download slides tutorial .","code":""},{"path":"deseq2-count-normalization.html","id":"learning-outcomes-1","chapter":"10 DESeq2: count normalization","heading":"10.2 Learning outcomes","text":"end tutorial, able :Define challenges differential analysis.Apply different count normalization strategies.Reproduce count normalization DESeq2 R using tidyverseYou R RStudio installed. Please open RStudio work examples editing deseq.R script.","code":""},{"path":"deseq2-count-normalization.html","id":"setup-3","chapter":"10 DESeq2: count normalization","heading":"10.3 Setup","text":"","code":""},{"path":"deseq2-count-normalization.html","id":"r-packages-1","chapter":"10 DESeq2: count normalization","heading":"10.4 R packages","text":"work tidyverse package make sure loaded.","code":"\nlibrary(tidyverse)"},{"path":"deseq2-count-normalization.html","id":"data","chapter":"10 DESeq2: count normalization","heading":"10.5 Data","text":"RNAseq data collected Drosophila melanogaster splicing regulator Pasilla depleted RNAi (treated) (untreated) (1). Download data set pasilla_gene_counts.csv place deseq directory.","code":""},{"path":"deseq2-count-normalization.html","id":"working-with-data-frames","chapter":"10 DESeq2: count normalization","heading":"10.6 Working with data frames","text":"","code":""},{"path":"deseq2-count-normalization.html","id":"loading-tabular-data-from-a-file","chapter":"10 DESeq2: count normalization","heading":"10.6.1 Loading tabular data from a file","text":"Data frames can loaded R using many different functions. tidyverse, called read_*(). example, let’s inspect Spasilla_gene_counts.cs contains table using Notepad (Windows) TextEdit (macOS).notice first row different others, actually contains column names data. row first one makes row table. also notice commas separate values row. first element row (.e. first comma) makes value first column, second element value second column, . file described comma-separated values. reason, files format often extension .csv.can load pasilla_gene_counts.csv R read_csv comma-separated file specify arguments describe data follows:file: name file want load character data type, .e. wrapped quotes.col_names: can take either value TRUE FALSE tells R first row contains column names.data printed console R.","code":"gene_id,treated1,treated2,treated3,untreated1,untreated2,untreated3,untreated4\n0000003,0,0,1,0,0,0,0\n0000008,140,88,70,92,161,76,70\n0000014,4,0,0,5,1,0,0\nread_csv(file = \"pasilla_gene_counts.csv\", col_names = TRUE)"},{"path":"deseq2-count-normalization.html","id":"save-data-in-the-environment","chapter":"10 DESeq2: count normalization","heading":"10.6.2 Save data in the environment","text":"Since want data reading , need save variable R <- operator. can choose name object whatever like, though module assumes names used .","code":"\ncounts <- read_csv(file = \"pasilla_gene_counts.csv\", col_names = TRUE)"},{"path":"deseq2-count-normalization.html","id":"data-exploration","chapter":"10 DESeq2: count normalization","heading":"10.6.3 Data exploration","text":"Let’s explore data ’ve imported R clicking triangle counts Environment tab top-right pane. can see column data type long list.directly click counts Environment tab top-right pane, can view table. Row column names grey boxes, data white boxes.Using different functions, can look dimensions data, number rows, number columns:can list column names using colnames():can call specific columns using $ notation, useful calling entire column, regardless length. example, calling untreated1 column:","code":"## spec_tbl_df [14,599 × 8] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n##  $ gene_id   : chr [1:14599] \"0000003\" \"0000008\" \"0000014\" \"0000015\" ...\n##  $ treated1  : num [1:14599] 0 140 4 1 6205 ...\n##  $ treated2  : num [1:14599] 0 88 0 0 3072 ...\n##  $ treated3  : num [1:14599] 1 70 0 0 3334 ...\n##  $ untreated1: num [1:14599] 0 92 5 0 4664 ...\n##  $ untreated2: num [1:14599] 0 161 1 2 8714 ...\n##  $ untreated3: num [1:14599] 0 76 0 1 3564 ...\n##  $ untreated4: num [1:14599] 0 70 0 2 3150 310 0 3 0 672 ...\n# Number of rows followed by number of columns\ndim(counts)## [1] 14599     8\n# Number of rows\nnrow(counts)## [1] 14599\n# Number of columns\nncol(counts)## [1] 8\ncolnames(counts)## [1] \"gene_id\"    \"treated1\"   \"treated2\"   \"treated3\"   \"untreated1\"\n## [6] \"untreated2\" \"untreated3\" \"untreated4\"\nhead(counts$untreated1)## [1]    0   92    5    0 4664  583"},{"path":"deseq2-count-normalization.html","id":"data-wrangling-with-dplyr","chapter":"10 DESeq2: count normalization","heading":"10.7 Data wrangling with dplyr","text":"popular package data wrangling dplyr tidyverse. package good integrates well popular tools like ggplot2 rapidly become de-facto standard.dplyr code readable operations based using dplyr functions verbs (mutate(), filter(), …). verb works similarly:Input data frame first argument.arguments can refer variables local objects (.e. need use quotes around \"<variable>\" name can just directly refer <variable>).Output another data frame.","code":""},{"path":"deseq2-count-normalization.html","id":"creating-of-modifying-variables-with-mutate","chapter":"10 DESeq2: count normalization","heading":"10.7.1 Creating of modifying variables with mutate()","text":"Use mutate() apply transformation variable assign new variable. first step determining size factor sample, DESeq2 calculates natural logarithm gene count.want determine logarithm variable, code becomes quickly tedious repetitive.Instead, can use across() apply function variable overwrite . can select range variables <first_variable>:<last_variable>.Alternatively, can define variables function apply !. example, want skip gene_id.","code":"\ncounts_single_log_column <- mutate(counts, log_untreated1 = log(untreated1))\ncounts_two_log_column <- mutate(counts,\n                                log_untreated1 = log(untreated1),\n                                log_untreated2 = log(untreated2))\nlog_counts <- mutate(counts, across(treated1:untreated4, log))\nlog_counts <- mutate(counts, across(!gene_id, log))"},{"path":"deseq2-count-normalization.html","id":"summarizing-across-variables-with-rowwise-and-c_across","chapter":"10 DESeq2: count normalization","heading":"10.7.2 Summarizing across variables with rowwise() and c_across()","text":"can group data rowwise() use c_across(),calculate mean across multiple columns (step 2 DESeq2 normalization). mean log values sensitive outliers compared means count values .","code":"\nlog_counts_grouped <- rowwise(log_counts)\ngeometric_means <- mutate(log_counts_grouped,\n                          mean = mean(c_across(treated1:untreated4)))"},{"path":"deseq2-count-normalization.html","id":"piping-with","chapter":"10 DESeq2: count normalization","heading":"10.7.3 Piping with %>%","text":"basic dplyr verb syntax, functions lend piping, .e. taking output one function passing (default first) argument following function.","code":"\ngeometric_means <- log_counts %>% \n  rowwise() %>% \n  mutate(gm = mean(c_across(treated1:untreated4)))"},{"path":"deseq2-count-normalization.html","id":"remove-groupings-with-ungroup","chapter":"10 DESeq2: count normalization","heading":"10.7.4 Remove groupings with ungroup()","text":"finished row-wise operation, remove grouping ungroup().","code":"\ngeometric_means <- log_counts %>% \n  rowwise() %>% \n  mutate(gm = mean(c_across(treated1:untreated4))) %>% \n  ungroup()"},{"path":"deseq2-count-normalization.html","id":"filter","chapter":"10 DESeq2: count normalization","heading":"10.7.5 filter()","text":"Conditional statements logical operators essential working data R. can use filter() select specific rows based logical condition variable. quick reference, commonly used statements operators.step 3 DESeq2 count normalization, rows contain infinite value geometric mean removed. .infinite() return rows variable infinite. !.infinite() returns rows .step 4 DESeq2 count normalization, geometric mean subtracted \\(log(count) - log(gm) = log\\left(\\frac{{counts}}{{gm}}\\right)\\), .e. looks ratio sample mean.","code":"\ngeometric_means <- log_counts %>% \n  rowwise() %>% \n  mutate(gm = mean(c_across(treated1:untreated4))) %>% \n  ungroup() %>% \n  filter(!is.infinite(gm))\nratio <- geometric_means %>% \n  mutate(across(treated1:untreated4, ~ . - gm))"},{"path":"deseq2-count-normalization.html","id":"column-wise-operation-with-summarise","chapter":"10 DESeq2: count normalization","heading":"10.7.6 Column-wise operation with summarise()","text":"Now know ratio sample mean, select median() across remaining genes sample. calculate summary statistic column, use summarise(). Finally, take inverse logarithm receive size factor sample.","code":"\nsize_factors <- ratio %>% \n  summarise(across(treated1:untreated4, ~ exp(median(.))))"},{"path":"deseq2-count-normalization.html","id":"additional-resources-5","chapter":"10 DESeq2: count normalization","heading":"10.8 Additional resources","text":"","code":""},{"path":"deseq2-count-normalization.html","id":"count-normalization","chapter":"10 DESeq2: count normalization","heading":"10.8.1 Count normalization","text":"Introduction DGE Harvard Chan Bioinformatics CoreStatQuest: DESeq2 part 1: Library Normalization","code":""},{"path":"deseq2-count-normalization.html","id":"dplyr-and-tidyr","chapter":"10 DESeq2: count normalization","heading":"10.8.2 dplyr and tidyr","text":"R cheatsheets also available RStudio Help > CheatsheetsIntroduction dplyrdplyr tutorialdplyr video tutorialMore functions dplyr tidyr","code":""},{"path":"deseq2-independent-filtering.html","id":"deseq2-independent-filtering","chapter":"11 DESeq2: independent filtering","heading":"11 DESeq2: independent filtering","text":"tutorial, explore large number non-differentially expressed genes (negatives) affects discovery differentially expressed ones (positives). , generate toy data set,\n## SlidesYou can download slides tutorial .","code":""},{"path":"deseq2-independent-filtering.html","id":"learning-outcomes-2","chapter":"11 DESeq2: independent filtering","heading":"11.1 Learning outcomes","text":"Explain large number negatives controlling FDR affects retention positives.Explain large number negatives controlling FDR affects retention positives.Produce toy data set R explore relationship among FDR-controlling procedure, negatives positives.Produce toy data set R explore relationship among FDR-controlling procedure, negatives positives.Visualize population probability distributions R.Visualize population probability distributions R.Refactor code functions repeated use.Refactor code functions repeated use.","code":""},{"path":"deseq2-independent-filtering.html","id":"setup-4","chapter":"11 DESeq2: independent filtering","heading":"11.2 Setup","text":"{broom} package provides tools format many standard R output data frames.","code":"\nlibrary(tidyverse)\nlibrary(broom)"},{"path":"deseq2-independent-filtering.html","id":"generating-random-numbers-with-normal-distribution","chapter":"11 DESeq2: independent filtering","heading":"11.3 Generating random numbers with normal distribution","text":"","code":"\nlibrary(broom)\n# Ctrl+shift+R\n# Cmd/Ctrl_shift_P\nhead(rnorm(n = 1000, mean = 4, sd = 1))## [1] 2.854397 3.669913 4.823896 4.771322 4.948362 3.768346"},{"path":"deseq2-independent-filtering.html","id":"creating-data-frames","chapter":"11 DESeq2: independent filtering","heading":"11.3.1 Creating data frames","text":"","code":"\n# Need data table for plotting\ntibble(value = rnorm(n = 1000, mean = 4, sd = 1))## # A tibble: 1,000 × 1\n##    value\n##    <dbl>\n##  1  5.09\n##  2  2.99\n##  3  5.03\n##  4  3.55\n##  5  4.08\n##  6  4.67\n##  7  3.00\n##  8  4.43\n##  9  3.75\n## 10  3.14\n## # … with 990 more rows\nsingle_population <- tibble(population = \"population_1\",\n                            value = rnorm(n = 1000, mean = 4, sd = 1))"},{"path":"deseq2-independent-filtering.html","id":"visualizing-data-with-ggplot2","chapter":"11 DESeq2: independent filtering","heading":"11.4 Visualizing data with ggplot2","text":"ggplot2 add-package R. alternative base graphics become popular, point recommended/preferred unless old code already uses different graphing package.","code":""},{"path":"deseq2-independent-filtering.html","id":"why-ggplot","chapter":"11 DESeq2: independent filtering","heading":"11.4.1 Why ggplot?","text":"Wilkinson, Grammar Graphics (1999)Wilkinson, Grammar Graphics (1999)ggplot2 implementation GoG Rggplot2 implementation GoG RBenefits:\nHandsome default settings\nSnap-together building block approach\nAutomatic legends, colours, facets\nStatistical overlays: regressions lines smoothers (confidence intervals)\nBenefits:Handsome default settingsSnap-together building block approachAutomatic legends, colours, facetsStatistical overlays: regressions lines smoothers (confidence intervals)Drawbacks:\ncan hard get look exactly way want\nRequires input data certain format\nDrawbacks:can hard get look exactly way wantRequires input data certain format","code":""},{"path":"deseq2-independent-filtering.html","id":"ggplot-building-blocks","chapter":"11 DESeq2: independent filtering","heading":"11.4.2 ggplot building blocks","text":"organizing idea ggplot independently specify combine blocks create plot want. least three things specify create plot:DataAesthetic mappings data variables visual propertiesA layer describing draw properties","code":""},{"path":"deseq2-independent-filtering.html","id":"visualizing-distributions","chapter":"11 DESeq2: independent filtering","heading":"11.4.3 Visualizing distributions","text":"","code":"\nggplot(single_population, aes(x = value)) +\n  geom_histogram(bins = 50)\nggplot(single_population, aes(x = value)) +\n  geom_density()\n# Flexible with piping, adjusting values\ntibble(value = rnorm(n = 1000, mean = 4, sd = 1)) %>% \n  ggplot(aes(x = value)) +\n  geom_density()"},{"path":"deseq2-independent-filtering.html","id":"setting-random-numbers","chapter":"11 DESeq2: independent filtering","heading":"11.4.4 Setting random numbers","text":"Random numbers R randomly distributed come predetermined sequence. set.seed() allows us select specific set random numbers makes analysis reproducible, .e. someone else running analysis receive random numbers thus results dependent numbers.","code":"\nset.seed(212)\ntibble(value = rnorm(n = 1000, mean = 4, sd = 1)) %>% \n  ggplot(aes(x = value)) +\n  geom_density()\n# create 2 populations\nhead(c(rnorm(n = 1000, mean = 4, sd = 1),\n       rnorm(n = 1000, mean = 8, sd = 1)))## [1] 3.145517 5.476190 4.884132 2.469166 2.539946 4.562803\n# Use rep() to repeat elements\ntwo_populations <- tibble(\n  population =  rep(c(\"population_1\", \"population_2\"), each = 1000),\n  value      =  c(rnorm(n = 1000, mean = 4, sd = 1),\n                  rnorm(n = 1000, mean = 8, sd = 1))\n)\n\ntwo_populations %>% \n  ggplot(aes(x = value)) +\n  geom_histogram(bins = 50)"},{"path":"deseq2-independent-filtering.html","id":"creating-functions","chapter":"11 DESeq2: independent filtering","heading":"11.5 Creating functions","text":"","code":"\nget_t_test_p_value_between_normal_distributions <- function() {\n  sample_a <- rnorm(n = 3, mean = 4, sd = 1)\n  sample_b <- rnorm(n = 3, mean = 4, sd = 1)\n  result <- t.test(sample_a, sample_b)\n  tidy(result)$p.value\n}\n\np_values_for_non_differentially_expressed_genes <- tibble(\n  differentially_expressed = rep(FALSE, each = 1000),\n  p.value = replicate(1000, get_t_test_p_value_between_normal_distributions())\n)\n\np_values_for_non_differentially_expressed_genes %>% \n  ggplot(aes(x = p.value)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\nget_t_test_p_value_between_normal_distributions <- function(n,\n                                                            mean_1,\n                                                            sd_1,\n                                                            mean_2,\n                                                            sd_2) {\n  sample_a <- rnorm(n = n, mean = mean_1, sd = sd_1)\n  sample_b <- rnorm(n = n, mean = mean_2, sd = sd_2)\n  result <- t.test(sample_a, sample_b)\n  tidy(result)$p.value\n}\n\n# Provide default values\nget_t_test_p_value_between_normal_distributions <- function(n      = 3,\n                                                            mean_1 = 0,\n                                                            sd_1   = 1,\n                                                            mean_2 = 0,\n                                                            sd_2   = 1) {\n  sample_a <- rnorm(n = n, mean = mean_1, sd = sd_1)\n  sample_b <- rnorm(n = n, mean = mean_2, sd = sd_2)\n  result <- t.test(sample_a, sample_b)\n  tidy(result)$p.value\n}\n\nget_t_test_p_value_between_normal_distributions(3,\n                                               mean_1 = 4, sd_1 = 1,\n                                               mean_2 = 8, sd_2 = 1)## [1] 0.003898247\np_values_for_differentially_expressed_genes <- tibble(\n  differentially_expressed = rep(TRUE, each = 1000),\n  p.value = replicate(\n    1000,\n    get_t_test_p_value_between_normal_distributions(3,\n                                                    mean_1 = 4, sd_1 = 1,\n                                                    mean_2 = 8, sd_2 = 1))\n)\n\np_values_for_differentially_expressed_genes %>% \n  ggplot(aes(x = p.value)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\n# combine data set\ndata_set <- bind_rows(p_values_for_non_differentially_expressed_genes,\n                      p_values_for_differentially_expressed_genes)\n\ndata_set %>% \n  ggplot(aes(x = p.value)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\n# Use colour\ndata_set %>% \n  ggplot(aes(x = p.value, fill = differentially_expressed)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\n# Fix sequence of plotting\ndata_set %>% \n  mutate(differentially_expressed = factor(differentially_expressed,\n                                           levels = c(\"TRUE\", \"FALSE\"))) %>% \n  ggplot(aes(x = p.value, fill = differentially_expressed)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\ndata_set <- data_set %>% \n  mutate(p.adj = p.adjust(p.value, method = \"fdr\"))\n\ndata_set %>% \n  mutate(differentially_expressed = factor(differentially_expressed,\n                                           levels = c(\"TRUE\", \"FALSE\"))) %>% \n  ggplot(aes(x = p.adj, fill = differentially_expressed)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\nsimluate_p_values_for_gene_expression <- function (\n    set_seed = 212,\n    number_differential_genes     = 1000,\n    number_non_differential_genes = 1000) {\n  p_values_for_non_differentially_expressed_genes <- tibble(\n    differentially_expressed = rep(FALSE, each = number_non_differential_genes),\n    p.value = replicate(\n      number_non_differential_genes,\n      get_t_test_p_value_between_normal_distributions(3,\n                                                      mean_1 = 4, sd_1 = 1,\n                                                      mean_2 = 4, sd_2 = 1))\n  )\n  p_values_for_differentially_expressed_genes <- tibble(\n    differentially_expressed = rep(TRUE, each = number_differential_genes),\n    p.value = replicate(\n      number_differential_genes,\n      get_t_test_p_value_between_normal_distributions(3,\n                                                      mean_1 = 4, sd_1 = 1,\n                                                      mean_2 = 8, sd_2 = 1))\n  )\n  bind_rows(p_values_for_non_differentially_expressed_genes,\n            p_values_for_differentially_expressed_genes) %>% \n    mutate(p.adj = p.adjust(p.value, method = \"fdr\"))\n  \n}\n\ndata_set <- simluate_p_values_for_gene_expression()\ndata_set %>%\n  mutate(differentially_expressed = factor(differentially_expressed,\n                                           levels = c(\"TRUE\", \"FALSE\"))) %>% \n  ggplot(aes(x = p.adj, fill = differentially_expressed)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\nsimluate_p_values_for_gene_expression(number_differential_genes = 1000,\n                                      number_non_differential_genes = 5000) %>% \n  mutate(differentially_expressed = factor(differentially_expressed,\n                                           levels = c(\"TRUE\", \"FALSE\"))) %>% \n  ggplot(aes(x = p.adj, fill = differentially_expressed)) +\n  geom_histogram(boundary = 0, binwidth = 0.05)\n# At one point do you not have any more True positives"},{"path":"deseq2-independent-filtering.html","id":"additional-resources-6","chapter":"11 DESeq2: independent filtering","heading":"11.6 Additional resources","text":"","code":""},{"path":"deseq2-independent-filtering.html","id":"independent-filtering","chapter":"11 DESeq2: independent filtering","heading":"11.6.1 Independent filtering:","text":"StatQuest: Filtering genes low read counts","code":""},{"path":"deseq2-independent-filtering.html","id":"ggplot2","chapter":"11 DESeq2: independent filtering","heading":"11.6.2 ggplot2","text":"ggplot FAQggplot FAQR cheatsheets also available RStudio Help > CheatsheetsR cheatsheets also available RStudio Help > Cheatsheetsggplot tutorial 1ggplot tutorial 1ggplot tutorial 2ggplot tutorial 2ggplot tutorial 3ggplot tutorial 3","code":""},{"path":"bash-cheat-sheet.html","id":"bash-cheat-sheet","chapter":"A Bash cheat sheet","heading":"A Bash cheat sheet","text":"TABLE .1:  Shell cheat sheetChange directory.. parent directory~ home directory- last visited directoryList files directory-l listLook text filehelp navigationquitCopy files local serverGive file path server <user>@<server address>:<file path>Get list command historyFollow !<number> execute corresponding command -<filename> save history current session text file document workman <command>help <command><command> --helpCreate virtual terminal continues run jobs even connection server terminates-S <session name> create session <session name>-ls list running sessions-r <session name> resume sessionTo leave session keep running, first ctrl+activate commands screen, detach","code":""},{"path":"terminal-keyboard-shortcuts-1.html","id":"terminal-keyboard-shortcuts-1","chapter":"B Terminal keyboard shortcuts","heading":"B Terminal keyboard shortcuts","text":"Terminal keyboard shortcuts","code":""},{"path":"less-and-man-navigation.html","id":"less-and-man-navigation","chapter":"C less and man navigation","heading":"C less and man navigation","text":"less man keyboard shortcutsJump tobeginningor endgshift + g","code":""},{"path":"resources-3.html","id":"resources-3","chapter":"D Resources","heading":"D Resources","text":"OPTIONAL resources want dive course topics depth. tested content appear lecture material.","code":""},{"path":"resources-3.html","id":"unix","chapter":"D Resources","heading":"D.1 Unix","text":"Software Carpentry - UNIX Novice Coursesandbox.bio Online Shell & Tutorials","code":""},{"path":"resources-3.html","id":"r","chapter":"D Resources","heading":"D.2 R","text":"R Data ScienceSoftware Carpentry - Programming RSoftware Carpentry - R Reproducible Scientific Analysis","code":""},{"path":"resources-3.html","id":"bioinformatics","chapter":"D Resources","heading":"D.3 Bioinformatics","text":"Bioinformatics Data Skills (Unix, R, & much, much )","code":""},{"path":"references.html","id":"references","chapter":"E References","heading":"E References","text":"1. Brooks , Yang L, Duff MO, Hansen KD, Park JW, Dudoit S, Brenner SE, Graveley BR. 2011. Conservation RNA regulatory map Drosophila mammals. Genome Research 21:193–202.","code":""}]
